"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, /**
 * Creates a proxy for the given request that has its own TransactionID
 */ "default", {
    enumerable: true,
    get: function() {
        return isolateTransactionID;
    }
});
function isolateTransactionID(req) {
    const delegate = {};
    const handler = {
        deleteProperty (target, p) {
            return Reflect.deleteProperty(p === 'transactionID' ? delegate : target, p);
        },
        get (target, p, receiver) {
            return Reflect.get(p === 'transactionID' ? delegate : target, p, receiver);
        },
        has (target, p) {
            return Reflect.has(p === 'transactionID' ? delegate : target, p);
        },
        set (target, p, newValue, receiver) {
            if (p === 'transactionID') {
                // in case of transactionID we must ignore any receiver, because
                // "If provided and target does not have a setter for propertyKey, the property will be set on receiver instead."
                return Reflect.set(delegate, p, newValue);
            } else {
                return Reflect.set(target, p, newValue, receiver);
            }
        }
    };
    return new Proxy(req, handler);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvaXNvbGF0ZVRyYW5zYWN0aW9uSUQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBQYXlsb2FkUmVxdWVzdCB9IGZyb20gJy4uL2V4cHJlc3MvdHlwZXMnXG5cbi8qKlxuICogQ3JlYXRlcyBhIHByb3h5IGZvciB0aGUgZ2l2ZW4gcmVxdWVzdCB0aGF0IGhhcyBpdHMgb3duIFRyYW5zYWN0aW9uSURcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNvbGF0ZVRyYW5zYWN0aW9uSUQocmVxOiBQYXlsb2FkUmVxdWVzdCk6IFBheWxvYWRSZXF1ZXN0IHtcbiAgY29uc3QgZGVsZWdhdGUgPSB7fVxuICBjb25zdCBoYW5kbGVyOiBQcm94eUhhbmRsZXI8UGF5bG9hZFJlcXVlc3Q+ID0ge1xuICAgIGRlbGV0ZVByb3BlcnR5KHRhcmdldCwgcCk6IGJvb2xlYW4ge1xuICAgICAgcmV0dXJuIFJlZmxlY3QuZGVsZXRlUHJvcGVydHkocCA9PT0gJ3RyYW5zYWN0aW9uSUQnID8gZGVsZWdhdGUgOiB0YXJnZXQsIHApXG4gICAgfSxcbiAgICBnZXQodGFyZ2V0LCBwLCByZWNlaXZlcikge1xuICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0KHAgPT09ICd0cmFuc2FjdGlvbklEJyA/IGRlbGVnYXRlIDogdGFyZ2V0LCBwLCByZWNlaXZlcilcbiAgICB9LFxuICAgIGhhcyh0YXJnZXQsIHApIHtcbiAgICAgIHJldHVybiBSZWZsZWN0LmhhcyhwID09PSAndHJhbnNhY3Rpb25JRCcgPyBkZWxlZ2F0ZSA6IHRhcmdldCwgcClcbiAgICB9LFxuICAgIHNldCh0YXJnZXQsIHAsIG5ld1ZhbHVlLCByZWNlaXZlcikge1xuICAgICAgaWYgKHAgPT09ICd0cmFuc2FjdGlvbklEJykge1xuICAgICAgICAvLyBpbiBjYXNlIG9mIHRyYW5zYWN0aW9uSUQgd2UgbXVzdCBpZ25vcmUgYW55IHJlY2VpdmVyLCBiZWNhdXNlXG4gICAgICAgIC8vIFwiSWYgcHJvdmlkZWQgYW5kIHRhcmdldCBkb2VzIG5vdCBoYXZlIGEgc2V0dGVyIGZvciBwcm9wZXJ0eUtleSwgdGhlIHByb3BlcnR5IHdpbGwgYmUgc2V0IG9uIHJlY2VpdmVyIGluc3RlYWQuXCJcbiAgICAgICAgcmV0dXJuIFJlZmxlY3Quc2V0KGRlbGVnYXRlLCBwLCBuZXdWYWx1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBSZWZsZWN0LnNldCh0YXJnZXQsIHAsIG5ld1ZhbHVlLCByZWNlaXZlcilcbiAgICAgIH1cbiAgICB9LFxuICB9XG4gIHJldHVybiBuZXcgUHJveHkocmVxLCBoYW5kbGVyKVxufVxuIl0sIm5hbWVzIjpbImlzb2xhdGVUcmFuc2FjdGlvbklEIiwicmVxIiwiZGVsZWdhdGUiLCJoYW5kbGVyIiwiZGVsZXRlUHJvcGVydHkiLCJ0YXJnZXQiLCJwIiwiUmVmbGVjdCIsImdldCIsInJlY2VpdmVyIiwiaGFzIiwic2V0IiwibmV3VmFsdWUiLCJQcm94eSJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFFQTs7Q0FFQyxHQUNEOzs7ZUFBd0JBOzs7QUFBVCxTQUFTQSxxQkFBcUJDLEdBQW1CO0lBQzlELE1BQU1DLFdBQVcsQ0FBQztJQUNsQixNQUFNQyxVQUF3QztRQUM1Q0MsZ0JBQWVDLE1BQU0sRUFBRUMsQ0FBQztZQUN0QixPQUFPQyxRQUFRSCxjQUFjLENBQUNFLE1BQU0sa0JBQWtCSixXQUFXRyxRQUFRQztRQUMzRTtRQUNBRSxLQUFJSCxNQUFNLEVBQUVDLENBQUMsRUFBRUcsUUFBUTtZQUNyQixPQUFPRixRQUFRQyxHQUFHLENBQUNGLE1BQU0sa0JBQWtCSixXQUFXRyxRQUFRQyxHQUFHRztRQUNuRTtRQUNBQyxLQUFJTCxNQUFNLEVBQUVDLENBQUM7WUFDWCxPQUFPQyxRQUFRRyxHQUFHLENBQUNKLE1BQU0sa0JBQWtCSixXQUFXRyxRQUFRQztRQUNoRTtRQUNBSyxLQUFJTixNQUFNLEVBQUVDLENBQUMsRUFBRU0sUUFBUSxFQUFFSCxRQUFRO1lBQy9CLElBQUlILE1BQU0saUJBQWlCO2dCQUN6QixnRUFBZ0U7Z0JBQ2hFLGlIQUFpSDtnQkFDakgsT0FBT0MsUUFBUUksR0FBRyxDQUFDVCxVQUFVSSxHQUFHTTtZQUNsQyxPQUFPO2dCQUNMLE9BQU9MLFFBQVFJLEdBQUcsQ0FBQ04sUUFBUUMsR0FBR00sVUFBVUg7WUFDMUM7UUFDRjtJQUNGO0lBQ0EsT0FBTyxJQUFJSSxNQUFNWixLQUFLRTtBQUN4QiJ9