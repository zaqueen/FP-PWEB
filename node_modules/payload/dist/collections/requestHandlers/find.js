"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, // eslint-disable-next-line @typescript-eslint/no-explicit-any
"default", {
    enumerable: true,
    get: function() {
        return findHandler;
    }
});
const _httpstatus = /*#__PURE__*/ _interop_require_default(require("http-status"));
const _isNumber = require("../../utilities/isNumber");
const _find = /*#__PURE__*/ _interop_require_default(require("../operations/find"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
async function findHandler(req, res, next) {
    try {
        let page;
        if (typeof req.query.page === 'string') {
            const parsedPage = parseInt(req.query.page, 10);
            if (!Number.isNaN(parsedPage)) {
                page = parsedPage;
            }
        }
        const result = await (0, _find.default)({
            collection: req.collection,
            depth: (0, _isNumber.isNumber)(req.query.depth) ? Number(req.query.depth) : undefined,
            draft: req.query.draft === 'true',
            limit: (0, _isNumber.isNumber)(req.query.limit) ? Number(req.query.limit) : undefined,
            page,
            req,
            sort: req.query.sort,
            where: req.query.where
        });
        return res.status(_httpstatus.default.OK).json(result);
    } catch (error) {
        return next(error);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb2xsZWN0aW9ucy9yZXF1ZXN0SGFuZGxlcnMvZmluZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRGdW5jdGlvbiwgUmVzcG9uc2UgfSBmcm9tICdleHByZXNzJ1xuXG5pbXBvcnQgaHR0cFN0YXR1cyBmcm9tICdodHRwLXN0YXR1cydcblxuaW1wb3J0IHR5cGUgeyBQYWdpbmF0ZWREb2NzIH0gZnJvbSAnLi4vLi4vZGF0YWJhc2UvdHlwZXMnXG5pbXBvcnQgdHlwZSB7IFBheWxvYWRSZXF1ZXN0IH0gZnJvbSAnLi4vLi4vZXhwcmVzcy90eXBlcydcbmltcG9ydCB0eXBlIHsgV2hlcmUgfSBmcm9tICcuLi8uLi90eXBlcydcbmltcG9ydCB0eXBlIHsgVHlwZVdpdGhJRCB9IGZyb20gJy4uL2NvbmZpZy90eXBlcydcblxuaW1wb3J0IHsgaXNOdW1iZXIgfSBmcm9tICcuLi8uLi91dGlsaXRpZXMvaXNOdW1iZXInXG5pbXBvcnQgZmluZCBmcm9tICcuLi9vcGVyYXRpb25zL2ZpbmQnXG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBmaW5kSGFuZGxlcjxUIGV4dGVuZHMgVHlwZVdpdGhJRCA9IGFueT4oXG4gIHJlcTogUGF5bG9hZFJlcXVlc3QsXG4gIHJlczogUmVzcG9uc2UsXG4gIG5leHQ6IE5leHRGdW5jdGlvbixcbik6IFByb21pc2U8UmVzcG9uc2U8UGFnaW5hdGVkRG9jczxUPj4gfCB2b2lkPiB7XG4gIHRyeSB7XG4gICAgbGV0IHBhZ2U6IG51bWJlciB8IHVuZGVmaW5lZFxuXG4gICAgaWYgKHR5cGVvZiByZXEucXVlcnkucGFnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGNvbnN0IHBhcnNlZFBhZ2UgPSBwYXJzZUludChyZXEucXVlcnkucGFnZSwgMTApXG5cbiAgICAgIGlmICghTnVtYmVyLmlzTmFOKHBhcnNlZFBhZ2UpKSB7XG4gICAgICAgIHBhZ2UgPSBwYXJzZWRQYWdlXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZmluZCh7XG4gICAgICBjb2xsZWN0aW9uOiByZXEuY29sbGVjdGlvbixcbiAgICAgIGRlcHRoOiBpc051bWJlcihyZXEucXVlcnkuZGVwdGgpID8gTnVtYmVyKHJlcS5xdWVyeS5kZXB0aCkgOiB1bmRlZmluZWQsXG4gICAgICBkcmFmdDogcmVxLnF1ZXJ5LmRyYWZ0ID09PSAndHJ1ZScsXG4gICAgICBsaW1pdDogaXNOdW1iZXIocmVxLnF1ZXJ5LmxpbWl0KSA/IE51bWJlcihyZXEucXVlcnkubGltaXQpIDogdW5kZWZpbmVkLFxuICAgICAgcGFnZSxcbiAgICAgIHJlcSxcbiAgICAgIHNvcnQ6IHJlcS5xdWVyeS5zb3J0IGFzIHN0cmluZyxcbiAgICAgIHdoZXJlOiByZXEucXVlcnkud2hlcmUgYXMgV2hlcmUsIC8vIFRoaXMgaXMgYSBsaXR0bGUgc2hhZHlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoaHR0cFN0YXR1cy5PSykuanNvbihyZXN1bHQpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG5leHQoZXJyb3IpXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmaW5kSGFuZGxlciIsInJlcSIsInJlcyIsIm5leHQiLCJwYWdlIiwicXVlcnkiLCJwYXJzZWRQYWdlIiwicGFyc2VJbnQiLCJOdW1iZXIiLCJpc05hTiIsInJlc3VsdCIsImZpbmQiLCJjb2xsZWN0aW9uIiwiZGVwdGgiLCJpc051bWJlciIsInVuZGVmaW5lZCIsImRyYWZ0IiwibGltaXQiLCJzb3J0Iiwid2hlcmUiLCJzdGF0dXMiLCJodHRwU3RhdHVzIiwiT0siLCJqc29uIiwiZXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7K0JBWUEsOERBQThEO0FBQzlEOzs7ZUFBOEJBOzs7bUVBWFA7MEJBT0U7NkRBQ1I7Ozs7OztBQUdGLGVBQWVBLFlBQzVCQyxHQUFtQixFQUNuQkMsR0FBYSxFQUNiQyxJQUFrQjtJQUVsQixJQUFJO1FBQ0YsSUFBSUM7UUFFSixJQUFJLE9BQU9ILElBQUlJLEtBQUssQ0FBQ0QsSUFBSSxLQUFLLFVBQVU7WUFDdEMsTUFBTUUsYUFBYUMsU0FBU04sSUFBSUksS0FBSyxDQUFDRCxJQUFJLEVBQUU7WUFFNUMsSUFBSSxDQUFDSSxPQUFPQyxLQUFLLENBQUNILGFBQWE7Z0JBQzdCRixPQUFPRTtZQUNUO1FBQ0Y7UUFFQSxNQUFNSSxTQUFTLE1BQU1DLElBQUFBLGFBQUksRUFBQztZQUN4QkMsWUFBWVgsSUFBSVcsVUFBVTtZQUMxQkMsT0FBT0MsSUFBQUEsa0JBQVEsRUFBQ2IsSUFBSUksS0FBSyxDQUFDUSxLQUFLLElBQUlMLE9BQU9QLElBQUlJLEtBQUssQ0FBQ1EsS0FBSyxJQUFJRTtZQUM3REMsT0FBT2YsSUFBSUksS0FBSyxDQUFDVyxLQUFLLEtBQUs7WUFDM0JDLE9BQU9ILElBQUFBLGtCQUFRLEVBQUNiLElBQUlJLEtBQUssQ0FBQ1ksS0FBSyxJQUFJVCxPQUFPUCxJQUFJSSxLQUFLLENBQUNZLEtBQUssSUFBSUY7WUFDN0RYO1lBQ0FIO1lBQ0FpQixNQUFNakIsSUFBSUksS0FBSyxDQUFDYSxJQUFJO1lBQ3BCQyxPQUFPbEIsSUFBSUksS0FBSyxDQUFDYyxLQUFLO1FBQ3hCO1FBRUEsT0FBT2pCLElBQUlrQixNQUFNLENBQUNDLG1CQUFVLENBQUNDLEVBQUUsRUFBRUMsSUFBSSxDQUFDYjtJQUN4QyxFQUFFLE9BQU9jLE9BQU87UUFDZCxPQUFPckIsS0FBS3FCO0lBQ2Q7QUFDRiJ9