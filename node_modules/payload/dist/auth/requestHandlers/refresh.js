"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return refreshHandler;
    }
});
const _getExtractJWT = /*#__PURE__*/ _interop_require_default(require("../getExtractJWT"));
const _refresh = /*#__PURE__*/ _interop_require_default(require("../operations/refresh"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
async function refreshHandler(req, res, next) {
    try {
        let token;
        const extractJWT = (0, _getExtractJWT.default)(req.payload.config);
        token = extractJWT(req);
        if (req.body.token) {
            token = req.body.token;
        }
        const result = await (0, _refresh.default)({
            collection: req.collection,
            req,
            res,
            token
        });
        return res.status(200).json({
            message: 'Token refresh successful',
            ...result
        });
    } catch (error) {
        return next(error);
    }
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hdXRoL3JlcXVlc3RIYW5kbGVycy9yZWZyZXNoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgTmV4dEZ1bmN0aW9uLCBSZXNwb25zZSB9IGZyb20gJ2V4cHJlc3MnXG5cbmltcG9ydCB0eXBlIHsgUGF5bG9hZFJlcXVlc3QgfSBmcm9tICcuLi8uLi9leHByZXNzL3R5cGVzJ1xuXG5pbXBvcnQgZ2V0RXh0cmFjdEpXVCBmcm9tICcuLi9nZXRFeHRyYWN0SldUJ1xuaW1wb3J0IHJlZnJlc2ggZnJvbSAnLi4vb3BlcmF0aW9ucy9yZWZyZXNoJ1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiByZWZyZXNoSGFuZGxlcihcbiAgcmVxOiBQYXlsb2FkUmVxdWVzdCxcbiAgcmVzOiBSZXNwb25zZSxcbiAgbmV4dDogTmV4dEZ1bmN0aW9uLFxuKTogUHJvbWlzZTxhbnk+IHtcbiAgdHJ5IHtcbiAgICBsZXQgdG9rZW5cblxuICAgIGNvbnN0IGV4dHJhY3RKV1QgPSBnZXRFeHRyYWN0SldUKHJlcS5wYXlsb2FkLmNvbmZpZylcbiAgICB0b2tlbiA9IGV4dHJhY3RKV1QocmVxKVxuXG4gICAgaWYgKHJlcS5ib2R5LnRva2VuKSB7XG4gICAgICB0b2tlbiA9IHJlcS5ib2R5LnRva2VuXG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVmcmVzaCh7XG4gICAgICBjb2xsZWN0aW9uOiByZXEuY29sbGVjdGlvbixcbiAgICAgIHJlcSxcbiAgICAgIHJlcyxcbiAgICAgIHRva2VuLFxuICAgIH0pXG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgbWVzc2FnZTogJ1Rva2VuIHJlZnJlc2ggc3VjY2Vzc2Z1bCcsXG4gICAgICAuLi5yZXN1bHQsXG4gICAgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gbmV4dChlcnJvcilcbiAgfVxufVxuIl0sIm5hbWVzIjpbInJlZnJlc2hIYW5kbGVyIiwicmVxIiwicmVzIiwibmV4dCIsInRva2VuIiwiZXh0cmFjdEpXVCIsImdldEV4dHJhY3RKV1QiLCJwYXlsb2FkIiwiY29uZmlnIiwiYm9keSIsInJlc3VsdCIsInJlZnJlc2giLCJjb2xsZWN0aW9uIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFPQTs7O2VBQThCQTs7O3NFQUhKO2dFQUNOOzs7Ozs7QUFFTCxlQUFlQSxlQUM1QkMsR0FBbUIsRUFDbkJDLEdBQWEsRUFDYkMsSUFBa0I7SUFFbEIsSUFBSTtRQUNGLElBQUlDO1FBRUosTUFBTUMsYUFBYUMsSUFBQUEsc0JBQWEsRUFBQ0wsSUFBSU0sT0FBTyxDQUFDQyxNQUFNO1FBQ25ESixRQUFRQyxXQUFXSjtRQUVuQixJQUFJQSxJQUFJUSxJQUFJLENBQUNMLEtBQUssRUFBRTtZQUNsQkEsUUFBUUgsSUFBSVEsSUFBSSxDQUFDTCxLQUFLO1FBQ3hCO1FBRUEsTUFBTU0sU0FBUyxNQUFNQyxJQUFBQSxnQkFBTyxFQUFDO1lBQzNCQyxZQUFZWCxJQUFJVyxVQUFVO1lBQzFCWDtZQUNBQztZQUNBRTtRQUNGO1FBRUEsT0FBT0YsSUFBSVcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztZQUNULEdBQUdMLE1BQU07UUFDWDtJQUNGLEVBQUUsT0FBT00sT0FBTztRQUNkLE9BQU9iLEtBQUthO0lBQ2Q7QUFDRiJ9