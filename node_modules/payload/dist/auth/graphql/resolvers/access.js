"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _formatName = /*#__PURE__*/ _interop_require_default(require("../../../graphql/utilities/formatName"));
const _isolateTransactionID = /*#__PURE__*/ _interop_require_default(require("../../../utilities/isolateTransactionID"));
const _access = /*#__PURE__*/ _interop_require_default(require("../../operations/access"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const formatConfigNames = (results, configs)=>{
    const formattedResults = {
        ...results
    };
    configs.forEach(({ slug })=>{
        const result = {
            ...formattedResults[slug] || {}
        };
        delete formattedResults[slug];
        formattedResults[(0, _formatName.default)(slug)] = result;
    });
    return formattedResults;
};
function accessResolver(payload) {
    async function resolver(_, args, context) {
        const options = {
            req: (0, _isolateTransactionID.default)(context.req)
        };
        const accessResults = await (0, _access.default)(options);
        return {
            ...accessResults,
            ...formatConfigNames(accessResults.collections, payload.config.collections),
            ...formatConfigNames(accessResults.globals, payload.config.globals)
        };
    }
    return resolver;
}
const _default = accessResolver;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9hdXRoL2dyYXBocWwvcmVzb2x2ZXJzL2FjY2Vzcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFBheWxvYWQgfSBmcm9tICcuLi8uLi8uLi9wYXlsb2FkJ1xuXG5pbXBvcnQgZm9ybWF0TmFtZSBmcm9tICcuLi8uLi8uLi9ncmFwaHFsL3V0aWxpdGllcy9mb3JtYXROYW1lJ1xuaW1wb3J0IGlzb2xhdGVUcmFuc2FjdGlvbklEIGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9pc29sYXRlVHJhbnNhY3Rpb25JRCdcbmltcG9ydCBhY2Nlc3MgZnJvbSAnLi4vLi4vb3BlcmF0aW9ucy9hY2Nlc3MnXG5cbmNvbnN0IGZvcm1hdENvbmZpZ05hbWVzID0gKHJlc3VsdHMsIGNvbmZpZ3MpID0+IHtcbiAgY29uc3QgZm9ybWF0dGVkUmVzdWx0cyA9IHsgLi4ucmVzdWx0cyB9XG5cbiAgY29uZmlncy5mb3JFYWNoKCh7IHNsdWcgfSkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IHsgLi4uKGZvcm1hdHRlZFJlc3VsdHNbc2x1Z10gfHwge30pIH1cbiAgICBkZWxldGUgZm9ybWF0dGVkUmVzdWx0c1tzbHVnXVxuICAgIGZvcm1hdHRlZFJlc3VsdHNbZm9ybWF0TmFtZShzbHVnKV0gPSByZXN1bHRcbiAgfSlcblxuICByZXR1cm4gZm9ybWF0dGVkUmVzdWx0c1xufVxuXG5mdW5jdGlvbiBhY2Nlc3NSZXNvbHZlcihwYXlsb2FkOiBQYXlsb2FkKSB7XG4gIGFzeW5jIGZ1bmN0aW9uIHJlc29sdmVyKF8sIGFyZ3MsIGNvbnRleHQpIHtcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgcmVxOiBpc29sYXRlVHJhbnNhY3Rpb25JRChjb250ZXh0LnJlcSksXG4gICAgfVxuXG4gICAgY29uc3QgYWNjZXNzUmVzdWx0cyA9IGF3YWl0IGFjY2VzcyhvcHRpb25zKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmFjY2Vzc1Jlc3VsdHMsXG4gICAgICAuLi5mb3JtYXRDb25maWdOYW1lcyhhY2Nlc3NSZXN1bHRzLmNvbGxlY3Rpb25zLCBwYXlsb2FkLmNvbmZpZy5jb2xsZWN0aW9ucyksXG4gICAgICAuLi5mb3JtYXRDb25maWdOYW1lcyhhY2Nlc3NSZXN1bHRzLmdsb2JhbHMsIHBheWxvYWQuY29uZmlnLmdsb2JhbHMpLFxuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZXNvbHZlclxufVxuXG5leHBvcnQgZGVmYXVsdCBhY2Nlc3NSZXNvbHZlclxuIl0sIm5hbWVzIjpbImZvcm1hdENvbmZpZ05hbWVzIiwicmVzdWx0cyIsImNvbmZpZ3MiLCJmb3JtYXR0ZWRSZXN1bHRzIiwiZm9yRWFjaCIsInNsdWciLCJyZXN1bHQiLCJmb3JtYXROYW1lIiwiYWNjZXNzUmVzb2x2ZXIiLCJwYXlsb2FkIiwicmVzb2x2ZXIiLCJfIiwiYXJncyIsImNvbnRleHQiLCJvcHRpb25zIiwicmVxIiwiaXNvbGF0ZVRyYW5zYWN0aW9uSUQiLCJhY2Nlc3NSZXN1bHRzIiwiYWNjZXNzIiwiY29sbGVjdGlvbnMiLCJjb25maWciLCJnbG9iYWxzIl0sIm1hcHBpbmdzIjoiOzs7OytCQW9DQTs7O2VBQUE7OzttRUFsQ3VCOzZFQUNVOytEQUNkOzs7Ozs7QUFFbkIsTUFBTUEsb0JBQW9CLENBQUNDLFNBQVNDO0lBQ2xDLE1BQU1DLG1CQUFtQjtRQUFFLEdBQUdGLE9BQU87SUFBQztJQUV0Q0MsUUFBUUUsT0FBTyxDQUFDLENBQUMsRUFBRUMsSUFBSSxFQUFFO1FBQ3ZCLE1BQU1DLFNBQVM7WUFBRSxHQUFJSCxnQkFBZ0IsQ0FBQ0UsS0FBSyxJQUFJLENBQUMsQ0FBQztRQUFFO1FBQ25ELE9BQU9GLGdCQUFnQixDQUFDRSxLQUFLO1FBQzdCRixnQkFBZ0IsQ0FBQ0ksSUFBQUEsbUJBQVUsRUFBQ0YsTUFBTSxHQUFHQztJQUN2QztJQUVBLE9BQU9IO0FBQ1Q7QUFFQSxTQUFTSyxlQUFlQyxPQUFnQjtJQUN0QyxlQUFlQyxTQUFTQyxDQUFDLEVBQUVDLElBQUksRUFBRUMsT0FBTztRQUN0QyxNQUFNQyxVQUFVO1lBQ2RDLEtBQUtDLElBQUFBLDZCQUFvQixFQUFDSCxRQUFRRSxHQUFHO1FBQ3ZDO1FBRUEsTUFBTUUsZ0JBQWdCLE1BQU1DLElBQUFBLGVBQU0sRUFBQ0o7UUFFbkMsT0FBTztZQUNMLEdBQUdHLGFBQWE7WUFDaEIsR0FBR2pCLGtCQUFrQmlCLGNBQWNFLFdBQVcsRUFBRVYsUUFBUVcsTUFBTSxDQUFDRCxXQUFXLENBQUM7WUFDM0UsR0FBR25CLGtCQUFrQmlCLGNBQWNJLE9BQU8sRUFBRVosUUFBUVcsTUFBTSxDQUFDQyxPQUFPLENBQUM7UUFDckU7SUFDRjtJQUVBLE9BQU9YO0FBQ1Q7TUFFQSxXQUFlRiJ9