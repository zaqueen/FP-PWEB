"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _jsonwebtoken = /*#__PURE__*/ _interop_require_default(require("jsonwebtoken"));
const _url = /*#__PURE__*/ _interop_require_default(require("url"));
const _utils = require("../../collections/operations/utils");
const _errors = require("../../errors");
const _getCookieExpiration = /*#__PURE__*/ _interop_require_default(require("../../utilities/getCookieExpiration"));
const _getFieldsToSign = require("./getFieldsToSign");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
async function refresh(incomingArgs) {
    let args = incomingArgs;
    // /////////////////////////////////////
    // beforeOperation - Collection
    // /////////////////////////////////////
    await args.collection.config.hooks.beforeOperation.reduce(async (priorHook, hook)=>{
        await priorHook;
        args = await hook({
            args,
            collection: args.collection?.config,
            context: args.req.context,
            operation: 'refresh'
        }) || args;
    }, Promise.resolve());
    // /////////////////////////////////////
    // Refresh
    // /////////////////////////////////////
    const { collection: { config: collectionConfig }, req: { payload: { config, secret } } } = args;
    if (typeof args.token !== 'string' || !args.req.user) throw new _errors.Forbidden(args.req.t);
    const parsedURL = _url.default.parse(args.req.url);
    const isGraphQL = parsedURL.pathname === config.routes.graphQL;
    const user = await args.req.payload.findByID({
        id: args.req.user.id,
        collection: args.req.user.collection,
        depth: isGraphQL ? 0 : args.collection.config.auth.depth,
        req: args.req
    });
    const fieldsToSign = (0, _getFieldsToSign.getFieldsToSign)({
        collectionConfig,
        email: user?.email,
        user: args?.req?.user
    });
    const refreshedToken = _jsonwebtoken.default.sign(fieldsToSign, secret, {
        expiresIn: collectionConfig.auth.tokenExpiration
    });
    const exp = _jsonwebtoken.default.decode(refreshedToken).exp;
    if (args.res) {
        const cookieOptions = {
            domain: undefined,
            expires: (0, _getCookieExpiration.default)(collectionConfig.auth.tokenExpiration),
            httpOnly: true,
            path: '/',
            sameSite: collectionConfig.auth.cookies.sameSite,
            secure: collectionConfig.auth.cookies.secure
        };
        if (collectionConfig.auth.cookies.domain) cookieOptions.domain = collectionConfig.auth.cookies.domain;
        args.res.cookie(`${config.cookiePrefix}-token`, refreshedToken, cookieOptions);
    }
    let result = {
        exp,
        refreshedToken,
        user
    };
    // /////////////////////////////////////
    // After Refresh - Collection
    // /////////////////////////////////////
    await collectionConfig.hooks.afterRefresh.reduce(async (priorHook, hook)=>{
        await priorHook;
        result = await hook({
            collection: args.collection?.config,
            context: args.req.context,
            exp,
            req: args.req,
            res: args.res,
            token: refreshedToken
        }) || result;
    }, Promise.resolve());
    // /////////////////////////////////////
    // afterOperation - Collection
    // /////////////////////////////////////
    result = await (0, _utils.buildAfterOperation)({
        args,
        collection: args.collection?.config,
        operation: 'refresh',
        result
    });
    // /////////////////////////////////////
    // Return results
    // /////////////////////////////////////
    if (collectionConfig.auth.removeTokenFromResponses) {
        delete result.refreshedToken;
    }
    return result;
}
const _default = refresh;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9hdXRoL29wZXJhdGlvbnMvcmVmcmVzaC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFJlc3BvbnNlIH0gZnJvbSAnZXhwcmVzcydcblxuaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nXG5pbXBvcnQgdXJsIGZyb20gJ3VybCdcblxuaW1wb3J0IHR5cGUgeyBCZWZvcmVPcGVyYXRpb25Ib29rLCBDb2xsZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29sbGVjdGlvbnMvY29uZmlnL3R5cGVzJ1xuaW1wb3J0IHR5cGUgeyBQYXlsb2FkUmVxdWVzdCB9IGZyb20gJy4uLy4uL2V4cHJlc3MvdHlwZXMnXG5pbXBvcnQgdHlwZSB7IERvY3VtZW50IH0gZnJvbSAnLi4vLi4vdHlwZXMnXG5cbmltcG9ydCB7IGJ1aWxkQWZ0ZXJPcGVyYXRpb24gfSBmcm9tICcuLi8uLi9jb2xsZWN0aW9ucy9vcGVyYXRpb25zL3V0aWxzJ1xuaW1wb3J0IHsgRm9yYmlkZGVuIH0gZnJvbSAnLi4vLi4vZXJyb3JzJ1xuaW1wb3J0IGdldENvb2tpZUV4cGlyYXRpb24gZnJvbSAnLi4vLi4vdXRpbGl0aWVzL2dldENvb2tpZUV4cGlyYXRpb24nXG5pbXBvcnQgeyBnZXRGaWVsZHNUb1NpZ24gfSBmcm9tICcuL2dldEZpZWxkc1RvU2lnbidcblxuZXhwb3J0IHR5cGUgUmVzdWx0ID0ge1xuICBleHA6IG51bWJlclxuICByZWZyZXNoZWRUb2tlbjogc3RyaW5nXG4gIHVzZXI6IERvY3VtZW50XG59XG5cbmV4cG9ydCB0eXBlIEFyZ3VtZW50cyA9IHtcbiAgY29sbGVjdGlvbjogQ29sbGVjdGlvblxuICByZXE6IFBheWxvYWRSZXF1ZXN0XG4gIHJlcz86IFJlc3BvbnNlXG4gIHRva2VuOiBzdHJpbmdcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmVmcmVzaChpbmNvbWluZ0FyZ3M6IEFyZ3VtZW50cyk6IFByb21pc2U8UmVzdWx0PiB7XG4gIGxldCBhcmdzID0gaW5jb21pbmdBcmdzXG5cbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBiZWZvcmVPcGVyYXRpb24gLSBDb2xsZWN0aW9uXG4gIC8vIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICBhd2FpdCBhcmdzLmNvbGxlY3Rpb24uY29uZmlnLmhvb2tzLmJlZm9yZU9wZXJhdGlvbi5yZWR1Y2UoXG4gICAgYXN5bmMgKHByaW9ySG9vazogQmVmb3JlT3BlcmF0aW9uSG9vayB8IFByb21pc2U8dm9pZD4sIGhvb2s6IEJlZm9yZU9wZXJhdGlvbkhvb2spID0+IHtcbiAgICAgIGF3YWl0IHByaW9ySG9va1xuXG4gICAgICBhcmdzID1cbiAgICAgICAgKGF3YWl0IGhvb2soe1xuICAgICAgICAgIGFyZ3MsXG4gICAgICAgICAgY29sbGVjdGlvbjogYXJncy5jb2xsZWN0aW9uPy5jb25maWcsXG4gICAgICAgICAgY29udGV4dDogYXJncy5yZXEuY29udGV4dCxcbiAgICAgICAgICBvcGVyYXRpb246ICdyZWZyZXNoJyxcbiAgICAgICAgfSkpIHx8IGFyZ3NcbiAgICB9LFxuICAgIFByb21pc2UucmVzb2x2ZSgpLFxuICApXG5cbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBSZWZyZXNoXG4gIC8vIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICBjb25zdCB7XG4gICAgY29sbGVjdGlvbjogeyBjb25maWc6IGNvbGxlY3Rpb25Db25maWcgfSxcbiAgICByZXE6IHtcbiAgICAgIHBheWxvYWQ6IHsgY29uZmlnLCBzZWNyZXQgfSxcbiAgICB9LFxuICB9ID0gYXJnc1xuXG4gIGlmICh0eXBlb2YgYXJncy50b2tlbiAhPT0gJ3N0cmluZycgfHwgIWFyZ3MucmVxLnVzZXIpIHRocm93IG5ldyBGb3JiaWRkZW4oYXJncy5yZXEudClcblxuICBjb25zdCBwYXJzZWRVUkwgPSB1cmwucGFyc2UoYXJncy5yZXEudXJsKVxuICBjb25zdCBpc0dyYXBoUUwgPSBwYXJzZWRVUkwucGF0aG5hbWUgPT09IGNvbmZpZy5yb3V0ZXMuZ3JhcGhRTFxuXG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBhcmdzLnJlcS5wYXlsb2FkLmZpbmRCeUlEKHtcbiAgICBpZDogYXJncy5yZXEudXNlci5pZCxcbiAgICBjb2xsZWN0aW9uOiBhcmdzLnJlcS51c2VyLmNvbGxlY3Rpb24sXG4gICAgZGVwdGg6IGlzR3JhcGhRTCA/IDAgOiBhcmdzLmNvbGxlY3Rpb24uY29uZmlnLmF1dGguZGVwdGgsXG4gICAgcmVxOiBhcmdzLnJlcSxcbiAgfSlcblxuICBjb25zdCBmaWVsZHNUb1NpZ24gPSBnZXRGaWVsZHNUb1NpZ24oe1xuICAgIGNvbGxlY3Rpb25Db25maWcsXG4gICAgZW1haWw6IHVzZXI/LmVtYWlsIGFzIHN0cmluZyxcbiAgICB1c2VyOiBhcmdzPy5yZXE/LnVzZXIsXG4gIH0pXG5cbiAgY29uc3QgcmVmcmVzaGVkVG9rZW4gPSBqd3Quc2lnbihmaWVsZHNUb1NpZ24sIHNlY3JldCwge1xuICAgIGV4cGlyZXNJbjogY29sbGVjdGlvbkNvbmZpZy5hdXRoLnRva2VuRXhwaXJhdGlvbixcbiAgfSlcblxuICBjb25zdCBleHAgPSAoand0LmRlY29kZShyZWZyZXNoZWRUb2tlbikgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLmV4cCBhcyBudW1iZXJcblxuICBpZiAoYXJncy5yZXMpIHtcbiAgICBjb25zdCBjb29raWVPcHRpb25zID0ge1xuICAgICAgZG9tYWluOiB1bmRlZmluZWQsXG4gICAgICBleHBpcmVzOiBnZXRDb29raWVFeHBpcmF0aW9uKGNvbGxlY3Rpb25Db25maWcuYXV0aC50b2tlbkV4cGlyYXRpb24pLFxuICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICBwYXRoOiAnLycsXG4gICAgICBzYW1lU2l0ZTogY29sbGVjdGlvbkNvbmZpZy5hdXRoLmNvb2tpZXMuc2FtZVNpdGUsXG4gICAgICBzZWN1cmU6IGNvbGxlY3Rpb25Db25maWcuYXV0aC5jb29raWVzLnNlY3VyZSxcbiAgICB9XG5cbiAgICBpZiAoY29sbGVjdGlvbkNvbmZpZy5hdXRoLmNvb2tpZXMuZG9tYWluKVxuICAgICAgY29va2llT3B0aW9ucy5kb21haW4gPSBjb2xsZWN0aW9uQ29uZmlnLmF1dGguY29va2llcy5kb21haW5cblxuICAgIGFyZ3MucmVzLmNvb2tpZShgJHtjb25maWcuY29va2llUHJlZml4fS10b2tlbmAsIHJlZnJlc2hlZFRva2VuLCBjb29raWVPcHRpb25zKVxuICB9XG5cbiAgbGV0IHJlc3VsdDogUmVzdWx0ID0ge1xuICAgIGV4cCxcbiAgICByZWZyZXNoZWRUb2tlbixcbiAgICB1c2VyLFxuICB9XG5cbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBBZnRlciBSZWZyZXNoIC0gQ29sbGVjdGlvblxuICAvLyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgYXdhaXQgY29sbGVjdGlvbkNvbmZpZy5ob29rcy5hZnRlclJlZnJlc2gucmVkdWNlKGFzeW5jIChwcmlvckhvb2ssIGhvb2spID0+IHtcbiAgICBhd2FpdCBwcmlvckhvb2tcblxuICAgIHJlc3VsdCA9XG4gICAgICAoYXdhaXQgaG9vayh7XG4gICAgICAgIGNvbGxlY3Rpb246IGFyZ3MuY29sbGVjdGlvbj8uY29uZmlnLFxuICAgICAgICBjb250ZXh0OiBhcmdzLnJlcS5jb250ZXh0LFxuICAgICAgICBleHAsXG4gICAgICAgIHJlcTogYXJncy5yZXEsXG4gICAgICAgIHJlczogYXJncy5yZXMsXG4gICAgICAgIHRva2VuOiByZWZyZXNoZWRUb2tlbixcbiAgICAgIH0pKSB8fCByZXN1bHRcbiAgfSwgUHJvbWlzZS5yZXNvbHZlKCkpXG5cbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAvLyBhZnRlck9wZXJhdGlvbiAtIENvbGxlY3Rpb25cbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIHJlc3VsdCA9IGF3YWl0IGJ1aWxkQWZ0ZXJPcGVyYXRpb24oe1xuICAgIGFyZ3MsXG4gICAgY29sbGVjdGlvbjogYXJncy5jb2xsZWN0aW9uPy5jb25maWcsXG4gICAgb3BlcmF0aW9uOiAncmVmcmVzaCcsXG4gICAgcmVzdWx0LFxuICB9KVxuXG4gIC8vIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgLy8gUmV0dXJuIHJlc3VsdHNcbiAgLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gIGlmIChjb2xsZWN0aW9uQ29uZmlnLmF1dGgucmVtb3ZlVG9rZW5Gcm9tUmVzcG9uc2VzKSB7XG4gICAgZGVsZXRlIHJlc3VsdC5yZWZyZXNoZWRUb2tlblxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5leHBvcnQgZGVmYXVsdCByZWZyZXNoXG4iXSwibmFtZXMiOlsicmVmcmVzaCIsImluY29taW5nQXJncyIsImFyZ3MiLCJjb2xsZWN0aW9uIiwiY29uZmlnIiwiaG9va3MiLCJiZWZvcmVPcGVyYXRpb24iLCJyZWR1Y2UiLCJwcmlvckhvb2siLCJob29rIiwiY29udGV4dCIsInJlcSIsIm9wZXJhdGlvbiIsIlByb21pc2UiLCJyZXNvbHZlIiwiY29sbGVjdGlvbkNvbmZpZyIsInBheWxvYWQiLCJzZWNyZXQiLCJ0b2tlbiIsInVzZXIiLCJGb3JiaWRkZW4iLCJ0IiwicGFyc2VkVVJMIiwidXJsIiwicGFyc2UiLCJpc0dyYXBoUUwiLCJwYXRobmFtZSIsInJvdXRlcyIsImdyYXBoUUwiLCJmaW5kQnlJRCIsImlkIiwiZGVwdGgiLCJhdXRoIiwiZmllbGRzVG9TaWduIiwiZ2V0RmllbGRzVG9TaWduIiwiZW1haWwiLCJyZWZyZXNoZWRUb2tlbiIsImp3dCIsInNpZ24iLCJleHBpcmVzSW4iLCJ0b2tlbkV4cGlyYXRpb24iLCJleHAiLCJkZWNvZGUiLCJyZXMiLCJjb29raWVPcHRpb25zIiwiZG9tYWluIiwidW5kZWZpbmVkIiwiZXhwaXJlcyIsImdldENvb2tpZUV4cGlyYXRpb24iLCJodHRwT25seSIsInBhdGgiLCJzYW1lU2l0ZSIsImNvb2tpZXMiLCJzZWN1cmUiLCJjb29raWUiLCJjb29raWVQcmVmaXgiLCJyZXN1bHQiLCJhZnRlclJlZnJlc2giLCJidWlsZEFmdGVyT3BlcmF0aW9uIiwicmVtb3ZlVG9rZW5Gcm9tUmVzcG9uc2VzIl0sIm1hcHBpbmdzIjoiOzs7OytCQWtKQTs7O2VBQUE7OztxRUFoSmdCOzREQUNBO3VCQU1vQjt3QkFDVjs0RUFDTTtpQ0FDQTs7Ozs7O0FBZWhDLGVBQWVBLFFBQVFDLFlBQXVCO0lBQzVDLElBQUlDLE9BQU9EO0lBRVgsd0NBQXdDO0lBQ3hDLCtCQUErQjtJQUMvQix3Q0FBd0M7SUFFeEMsTUFBTUMsS0FBS0MsVUFBVSxDQUFDQyxNQUFNLENBQUNDLEtBQUssQ0FBQ0MsZUFBZSxDQUFDQyxNQUFNLENBQ3ZELE9BQU9DLFdBQWdEQztRQUNyRCxNQUFNRDtRQUVOTixPQUNFLEFBQUMsTUFBTU8sS0FBSztZQUNWUDtZQUNBQyxZQUFZRCxLQUFLQyxVQUFVLEVBQUVDO1lBQzdCTSxTQUFTUixLQUFLUyxHQUFHLENBQUNELE9BQU87WUFDekJFLFdBQVc7UUFDYixNQUFPVjtJQUNYLEdBQ0FXLFFBQVFDLE9BQU87SUFHakIsd0NBQXdDO0lBQ3hDLFVBQVU7SUFDVix3Q0FBd0M7SUFFeEMsTUFBTSxFQUNKWCxZQUFZLEVBQUVDLFFBQVFXLGdCQUFnQixFQUFFLEVBQ3hDSixLQUFLLEVBQ0hLLFNBQVMsRUFBRVosTUFBTSxFQUFFYSxNQUFNLEVBQUUsRUFDNUIsRUFDRixHQUFHZjtJQUVKLElBQUksT0FBT0EsS0FBS2dCLEtBQUssS0FBSyxZQUFZLENBQUNoQixLQUFLUyxHQUFHLENBQUNRLElBQUksRUFBRSxNQUFNLElBQUlDLGlCQUFTLENBQUNsQixLQUFLUyxHQUFHLENBQUNVLENBQUM7SUFFcEYsTUFBTUMsWUFB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