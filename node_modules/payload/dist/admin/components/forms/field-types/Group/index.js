"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _reacti18next = require("react-i18next");
const _getTranslation = require("../../../../../utilities/getTranslation");
const _provider = require("../../../elements/Collapsible/provider");
const _ErrorPill = require("../../../elements/ErrorPill");
const _FieldDescription = /*#__PURE__*/ _interop_require_default(require("../../FieldDescription"));
const _context = require("../../Form/context");
const _createNestedFieldPath = require("../../Form/createNestedFieldPath");
const _RenderFields = /*#__PURE__*/ _interop_require_default(require("../../RenderFields"));
const _WatchChildErrors = require("../../WatchChildErrors");
const _withCondition = /*#__PURE__*/ _interop_require_default(require("../../withCondition"));
const _provider1 = require("../Row/provider");
const _provider2 = require("../Tabs/provider");
const _shared = require("../shared");
require("./index.scss");
const _provider3 = require("./provider");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const baseClass = 'group-field';
const Group = (props)=>{
    const { name, admin: { className, description, hideGutter = false, readOnly, style, width }, fieldTypes, fields, forceRender = false, indexPath, label, path: pathFromProps, permissions } = props;
    const isWithinCollapsible = (0, _provider.useCollapsible)();
    const isWithinGroup = (0, _provider3.useGroup)();
    const isWithinRow = (0, _provider1.useRow)();
    const isWithinTab = (0, _provider2.useTabs)();
    const { i18n } = (0, _reacti18next.useTranslation)();
    const submitted = (0, _context.useFormSubmitted)();
    const [errorCount, setErrorCount] = _react.default.useState(undefined);
    const groupHasErrors = submitted && errorCount > 0;
    const path = pathFromProps || name;
    const isTopLevel = !(isWithinCollapsible || isWithinGroup || isWithinRow);
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: [
            _shared.fieldBaseClass,
            baseClass,
            isTopLevel && `${baseClass}--top-level`,
            isWithinCollapsible && `${baseClass}--within-collapsible`,
            isWithinGroup && `${baseClass}--within-group`,
            isWithinRow && `${baseClass}--within-row`,
            isWithinTab && `${baseClass}--within-tab`,
            !hideGutter && isWithinGroup && `${baseClass}--gutter`,
            groupHasErrors && `${baseClass}--has-error`,
            className
        ].filter(Boolean).join(' '),
        id: `field-${path.replace(/\./g, '__')}`,
        style: {
            ...style,
            width
        }
    }, /*#__PURE__*/ _react.default.createElement(_WatchChildErrors.WatchChildErrors, {
        fieldSchema: fields,
        path: path,
        setErrorCount: setErrorCount
    }), /*#__PURE__*/ _react.default.createElement(_provider3.GroupProvider, null, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__wrap`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__header`
    }, (label || description) && /*#__PURE__*/ _react.default.createElement("header", null, label && /*#__PURE__*/ _react.default.createElement("h3", {
        className: `${baseClass}__title`
    }, (0, _getTranslation.getTranslation)(label, i18n)), /*#__PURE__*/ _react.default.createElement(_FieldDescription.default, {
        className: `field-description-${path.replace(/\./g, '__')}`,
        description: description,
        value: null
    })), groupHasErrors && /*#__PURE__*/ _react.default.createElement(_ErrorPill.ErrorPill, {
        count: errorCount,
        withMessage: true
    })), /*#__PURE__*/ _react.default.createElement(_RenderFields.default, {
        fieldSchema: fields.map((subField)=>({
                ...subField,
                path: (0, _createNestedFieldPath.createNestedFieldPath)(path, subField)
            })),
        fieldTypes: fieldTypes,
        forceRender: forceRender,
        indexPath: indexPath,
        margins: "small",
        permissions: permissions?.fields,
        readOnly: readOnly
    }))));
};
const _default = (0, _withCondition.default)(Group);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL2ZpZWxkLXR5cGVzL0dyb3VwL2luZGV4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gJ3JlYWN0LWkxOG5leHQnXG5cbmltcG9ydCB0eXBlIHsgUHJvcHMgfSBmcm9tICcuL3R5cGVzJ1xuXG5pbXBvcnQgeyBnZXRUcmFuc2xhdGlvbiB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3V0aWxpdGllcy9nZXRUcmFuc2xhdGlvbidcbmltcG9ydCB7IHVzZUNvbGxhcHNpYmxlIH0gZnJvbSAnLi4vLi4vLi4vZWxlbWVudHMvQ29sbGFwc2libGUvcHJvdmlkZXInXG5pbXBvcnQgeyBFcnJvclBpbGwgfSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9FcnJvclBpbGwnXG5pbXBvcnQgRmllbGREZXNjcmlwdGlvbiBmcm9tICcuLi8uLi9GaWVsZERlc2NyaXB0aW9uJ1xuaW1wb3J0IHsgdXNlRm9ybVN1Ym1pdHRlZCB9IGZyb20gJy4uLy4uL0Zvcm0vY29udGV4dCdcbmltcG9ydCB7IGNyZWF0ZU5lc3RlZEZpZWxkUGF0aCB9IGZyb20gJy4uLy4uL0Zvcm0vY3JlYXRlTmVzdGVkRmllbGRQYXRoJ1xuaW1wb3J0IFJlbmRlckZpZWxkcyBmcm9tICcuLi8uLi9SZW5kZXJGaWVsZHMnXG5pbXBvcnQgeyBXYXRjaENoaWxkRXJyb3JzIH0gZnJvbSAnLi4vLi4vV2F0Y2hDaGlsZEVycm9ycydcbmltcG9ydCB3aXRoQ29uZGl0aW9uIGZyb20gJy4uLy4uL3dpdGhDb25kaXRpb24nXG5pbXBvcnQgeyB1c2VSb3cgfSBmcm9tICcuLi9Sb3cvcHJvdmlkZXInXG5pbXBvcnQgeyB1c2VUYWJzIH0gZnJvbSAnLi4vVGFicy9wcm92aWRlcidcbmltcG9ydCB7IGZpZWxkQmFzZUNsYXNzIH0gZnJvbSAnLi4vc2hhcmVkJ1xuaW1wb3J0ICcuL2luZGV4LnNjc3MnXG5pbXBvcnQgeyBHcm91cFByb3ZpZGVyLCB1c2VHcm91cCB9IGZyb20gJy4vcHJvdmlkZXInXG5cbmNvbnN0IGJhc2VDbGFzcyA9ICdncm91cC1maWVsZCdcblxuY29uc3QgR3JvdXA6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCB7XG4gICAgbmFtZSxcbiAgICBhZG1pbjogeyBjbGFzc05hbWUsIGRlc2NyaXB0aW9uLCBoaWRlR3V0dGVyID0gZmFsc2UsIHJlYWRPbmx5LCBzdHlsZSwgd2lkdGggfSxcbiAgICBmaWVsZFR5cGVzLFxuICAgIGZpZWxkcyxcbiAgICBmb3JjZVJlbmRlciA9IGZhbHNlLFxuICAgIGluZGV4UGF0aCxcbiAgICBsYWJlbCxcbiAgICBwYXRoOiBwYXRoRnJvbVByb3BzLFxuICAgIHBlcm1pc3Npb25zLFxuICB9ID0gcHJvcHNcblxuICBjb25zdCBpc1dpdGhpbkNvbGxhcHNpYmxlID0gdXNlQ29sbGFwc2libGUoKVxuICBjb25zdCBpc1dpdGhpbkdyb3VwID0gdXNlR3JvdXAoKVxuICBjb25zdCBpc1dpdGhpblJvdyA9IHVzZVJvdygpXG4gIGNvbnN0IGlzV2l0aGluVGFiID0gdXNlVGFicygpXG4gIGNvbnN0IHsgaTE4biB9ID0gdXNlVHJhbnNsYXRpb24oKVxuICBjb25zdCBzdWJtaXR0ZWQgPSB1c2VGb3JtU3VibWl0dGVkKClcbiAgY29uc3QgW2Vycm9yQ291bnQsIHNldEVycm9yQ291bnRdID0gUmVhY3QudXNlU3RhdGUodW5kZWZpbmVkKVxuICBjb25zdCBncm91cEhhc0Vycm9ycyA9IHN1Ym1pdHRlZCAmJiBlcnJvckNvdW50ID4gMFxuXG4gIGNvbnN0IHBhdGggPSBwYXRoRnJvbVByb3BzIHx8IG5hbWVcbiAgY29uc3QgaXNUb3BMZXZlbCA9ICEoaXNXaXRoaW5Db2xsYXBzaWJsZSB8fCBpc1dpdGhpbkdyb3VwIHx8IGlzV2l0aGluUm93KVxuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgY2xhc3NOYW1lPXtbXG4gICAgICAgIGZpZWxkQmFzZUNsYXNzLFxuICAgICAgICBiYXNlQ2xhc3MsXG4gICAgICAgIGlzVG9wTGV2ZWwgJiYgYCR7YmFzZUNsYXNzfS0tdG9wLWxldmVsYCxcbiAgICAgICAgaXNXaXRoaW5Db2xsYXBzaWJsZSAmJiBgJHtiYXNlQ2xhc3N9LS13aXRoaW4tY29sbGFwc2libGVgLFxuICAgICAgICBpc1dpdGhpbkdyb3VwICYmIGAke2Jhc2VDbGFzc30tLXdpdGhpbi1ncm91cGAsXG4gICAgICAgIGlzV2l0aGluUm93ICYmIGAke2Jhc2VDbGFzc30tLXdpdGhpbi1yb3dgLFxuICAgICAgICBpc1dpdGhpblRhYiAmJiBgJHtiYXNlQ2xhc3N9LS13aXRoaW4tdGFiYCxcbiAgICAgICAgIWhpZGVHdXR0ZXIgJiYgaXNXaXRoaW5Hcm91cCAmJiBgJHtiYXNlQ2xhc3N9LS1ndXR0ZXJgLFxuICAgICAgICBncm91cEhhc0Vycm9ycyAmJiBgJHtiYXNlQ2xhc3N9LS1oYXMtZXJyb3JgLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICBdXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgLmpvaW4oJyAnKX1cbiAgICAgIGlkPXtgZmllbGQtJHtwYXRoLnJlcGxhY2UoL1xcLi9nLCAnX18nKX1gfVxuICAgICAgc3R5bGU9e3tcbiAgICAgICAgLi4uc3R5bGUsXG4gICAgICAgIHdpZHRoLFxuICAgICAgfX1cbiAgICA+XG4gICAgICA8V2F0Y2hDaGlsZEVycm9ycyBmaWVsZFNjaGVtYT17ZmllbGRzfSBwYXRoPXtwYXRofSBzZXRFcnJvckNvdW50PXtzZXRFcnJvckNvdW50fSAvPlxuICAgICAgPEdyb3VwUHJvdmlkZXI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X193cmFwYH0+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2hlYWRlcmB9PlxuICAgICAgICAgICAgeyhsYWJlbCB8fCBkZXNjcmlwdGlvbikgJiYgKFxuICAgICAgICAgICAgICA8aGVhZGVyPlxuICAgICAgICAgICAgICAgIHtsYWJlbCAmJiA8aDMgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X190aXRsZWB9PntnZXRUcmFuc2xhdGlvbihsYWJlbCwgaTE4bil9PC9oMz59XG4gICAgICAgICAgICAgICAgPEZpZWxkRGVzY3JpcHRpb25cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZpZWxkLWRlc2NyaXB0aW9uLSR7cGF0aC5yZXBsYWNlKC9cXC4vZywgJ19fJyl9YH1cbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uPXtkZXNjcmlwdGlvbn1cbiAgICAgICAgICAgICAgICAgIHZhbHVlPXtudWxsfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDwvaGVhZGVyPlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIHtncm91cEhhc0Vycm9ycyAmJiA8RXJyb3JQaWxsIGNvdW50PXtlcnJvckNvdW50fSB3aXRoTWVzc2FnZSAvPn1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8UmVuZGVyRmllbGRzXG4gICAgICAgICAgICBmaWVsZFNjaGVtYT17ZmllbGRzLm1hcCgoc3ViRmllbGQpID0+ICh7XG4gICAgICAgICAgICAgIC4uLnN1YkZpZWxkLFxuICAgICAgICAgICAgICBwYXRoOiBjcmVhdGVOZXN0ZWRGaWVsZFBhdGgocGF0aCwgc3ViRmllbGQpLFxuICAgICAgICAgICAgfSkpfVxuICAgICAgICAgICAgZmllbGRUeXBlcz17ZmllbGRUeXBlc31cbiAgICAgICAgICAgIGZvcmNlUmVuZGVyPXtmb3JjZVJlbmRlcn1cbiAgICAgICAgICAgIGluZGV4UGF0aD17aW5kZXhQYXRofVxuICAgICAgICAgICAgbWFyZ2lucz1cInNtYWxsXCJcbiAgICAgICAgICAgIHBlcm1pc3Npb25zPXtwZXJtaXNzaW9ucz8uZmllbGRzfVxuICAgICAgICAgICAgcmVhZE9ubHk9e3JlYWRPbmx5fVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9Hcm91cFByb3ZpZGVyPlxuICAgIDwvZGl2PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhDb25kaXRpb24oR3JvdXApXG4iXSwibmFtZXMiOlsiYmFzZUNsYXNzIiwiR3JvdXAiLCJwcm9wcyIsIm5hbWUiLCJhZG1pbiIsImNsYXNzTmFtZSIsImRlc2NyaXB0aW9uIiwiaGlkZUd1dHRlciIsInJlYWRPbmx5Iiwic3R5bGUiLCJ3aWR0aCIsImZpZWxkVHlwZXMiLCJmaWVsZHMiLCJmb3JjZVJlbmRlciIsImluZGV4UGF0aCIsImxhYmVsIiwicGF0aCIsInBhdGhGcm9tUHJvcHMiLCJwZXJtaXNzaW9ucyIsImlzV2l0aGluQ29sbGFwc2libGUiLCJ1c2VDb2xsYXBzaWJsZSIsImlzV2l0aGluR3JvdXAiLCJ1c2VHcm91cCIsImlzV2l0aGluUm93IiwidXNlUm93IiwiaXNXaXRoaW5UYWIiLCJ1c2VUYWJzIiwiaTE4biIsInVzZVRyYW5zbGF0aW9uIiwic3VibWl0dGVkIiwidXNlRm9ybVN1Ym1pdHRlZCIsImVycm9yQ291bnQiLCJzZXRFcnJvckNvdW50IiwiUmVhY3QiLCJ1c2VTdGF0ZSIsInVuZGVmaW5lZCIsImdyb3VwSGFzRXJyb3JzIiwiaXNUb3BMZXZlbCIsImRpdiIsImZpZWxkQmFzZUNsYXNzIiwiZmlsdGVyIiwiQm9vbGVhbiIsImpvaW4iLCJpZCIsInJlcGxhY2UiLCJXYXRjaENoaWxkRXJyb3JzIiwiZmllbGRTY2hlbWEiLCJHcm91cFByb3ZpZGVyIiwiaGVhZGVyIiwiaDMiLCJnZXRUcmFuc2xhdGlvbiIsIkZpZWxkRGVzY3JpcHRpb24iLCJ2YWx1ZSIsIkVycm9yUGlsbCIsImNvdW50Iiwid2l0aE1lc3NhZ2UiLCJSZW5kZXJGaWVsZHMiLCJtYXAiLCJzdWJGaWVsZCIsImNyZWF0ZU5lc3RlZEZpZWxkUGF0aCIsIm1hcmdpbnMiLCJ3aXRoQ29uZGl0aW9uIl0sIm1hcHBpbmdzIjoiOzs7OytCQXVHQTs7O2VBQUE7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