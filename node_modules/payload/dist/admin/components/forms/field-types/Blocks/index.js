"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _reacti18next = require("react-i18next");
const _validations = require("../../../../../fields/validations");
const _getTranslation = require("../../../../../utilities/getTranslation");
const _scrollToID = require("../../../../utilities/scrollToID");
const _Banner = /*#__PURE__*/ _interop_require_default(require("../../../elements/Banner"));
const _Button = /*#__PURE__*/ _interop_require_default(require("../../../elements/Button"));
const _DraggableSortable = /*#__PURE__*/ _interop_require_default(require("../../../elements/DraggableSortable"));
const _DraggableSortableItem = /*#__PURE__*/ _interop_require_default(require("../../../elements/DraggableSortable/DraggableSortableItem"));
const _Drawer = require("../../../elements/Drawer");
const _useDrawerSlug = require("../../../elements/Drawer/useDrawerSlug");
const _ErrorPill = require("../../../elements/ErrorPill");
const _Config = require("../../../utilities/Config");
const _DocumentInfo = require("../../../utilities/DocumentInfo");
const _Locale = require("../../../utilities/Locale");
const _Error = /*#__PURE__*/ _interop_require_default(require("../../Error"));
const _FieldDescription = /*#__PURE__*/ _interop_require_default(require("../../FieldDescription"));
const _context = require("../../Form/context");
const _NullifyField = require("../../NullifyField");
const _useField = /*#__PURE__*/ _interop_require_default(require("../../useField"));
const _withCondition = /*#__PURE__*/ _interop_require_default(require("../../withCondition"));
const _shared = require("../shared");
const _BlockRow = require("./BlockRow");
const _BlocksDrawer = require("./BlocksDrawer");
require("./index.scss");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {};
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const baseClass = 'blocks-field';
const BlocksField = (props)=>{
    const { i18n, t } = (0, _reacti18next.useTranslation)('fields');
    const { name, admin: { className, condition, description, readOnly }, blocks, fieldTypes, forceRender = false, indexPath, label, labels: labelsFromProps, localized, maxRows, minRows, path: pathFromProps, permissions, required, validate = _validations.blocks } = props;
    const path = pathFromProps || name;
    const { setDocFieldPreferences } = (0, _DocumentInfo.useDocumentInfo)();
    const { addFieldRow, dispatchFields, removeFieldRow, setModified } = (0, _context.useForm)();
    const { code: locale } = (0, _Locale.useLocale)();
    const { localization } = (0, _Config.useConfig)();
    const drawerSlug = (0, _useDrawerSlug.useDrawerSlug)('blocks-drawer');
    const submitted = (0, _context.useFormSubmitted)();
    const labels = {
        plural: t('blocks'),
        singular: t('block'),
        ...labelsFromProps
    };
    const editingDefaultLocale = (()=>{
        if (localization && localization.fallback) {
            const defaultLocale = localization.defaultLocale || 'en';
            return locale === defaultLocale;
        }
        return true;
    })();
    const memoizedValidate = (0, _react.useCallback)((value, options)=>{
        // alternative locales can be null
        if (!editingDefaultLocale && value === null) {
            return true;
        }
        return validate(value, {
            ...options,
            maxRows,
            minRows,
            required
        });
    }, [
        maxRows,
        minRows,
        required,
        validate,
        editingDefaultLocale
    ]);
    const { errorMessage, rows = [], showError, valid, value } = (0, _useField.default)({
        condition,
        hasRows: true,
        path,
        validate: memoizedValidate
    });
    const addRow = (0, _react.useCallback)(async (rowIndex, blockType)=>{
        await addFieldRow({
            data: {
                blockType
            },
            path,
            rowIndex
        });
        setModified(true);
        setTimeout(()=>{
            (0, _scrollToID.scrollToID)(`${path}-row-${rowIndex + 1}`);
        }, 0);
    }, [
        addFieldRow,
        path,
        setModified
    ]);
    const duplicateRow = (0, _react.useCallback)((rowIndex)=>{
        dispatchFields({
            path,
            rowIndex,
            type: 'DUPLICATE_ROW'
        });
        setModified(true);
        setTimeout(()=>{
            (0, _scrollToID.scrollToID)(`${path}-row-${rowIndex + 1}`);
        }, 0);
    }, [
        dispatchFields,
        path,
        setModified
    ]);
    const removeRow = (0, _react.useCallback)((rowIndex)=>{
        removeFieldRow({
            path,
            rowIndex
        });
        setModified(true);
    }, [
        path,
        removeFieldRow,
        setModified
    ]);
    const moveRow = (0, _react.useCallback)((moveFromIndex, moveToIndex)=>{
        dispatchFields({
            moveFromIndex,
            moveToIndex,
            path,
            type: 'MOVE_ROW'
        });
        setModified(true);
    }, [
        dispatchFields,
        path,
        setModified
    ]);
    const toggleCollapseAll = (0, _react.useCallback)((collapsed)=>{
        dispatchFields({
            collapsed,
            path,
            setDocFieldPreferences,
            type: 'SET_ALL_ROWS_COLLAPSED'
        });
    }, [
        dispatchFields,
        path,
        setDocFieldPreferences
    ]);
    const setCollapse = (0, _react.useCallback)((rowID, collapsed)=>{
        dispatchFields({
            collapsed,
            path,
            rowID,
            setDocFieldPreferences,
            type: 'SET_ROW_COLLAPSED'
        });
    }, [
        dispatchFields,
        path,
        setDocFieldPreferences
    ]);
    const hasMaxRows = maxRows && rows.length >= maxRows;
    const fieldErrorCount = rows.reduce((total, row)=>total + (row?.childErrorPaths?.size || 0), 0);
    const fieldHasErrors = submitted && fieldErrorCount + (valid ? 0 : 1) > 0;
    const showMinRows = rows.length < minRows || required && rows.length === 0;
    const showRequired = readOnly && rows.length === 0;
    return /*#__PURE__*/ _react.default.createElement("div", {
        className: [
            _shared.fieldBaseClass,
            baseClass,
            className,
            fieldHasErrors ? `${baseClass}--has-error` : `${baseClass}--has-no-error`
        ].filter(Boolean).join(' '),
        id: `field-${path.replace(/\./g, '__')}`
    }, showError && /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__error-wrap`
    }, /*#__PURE__*/ _react.default.createElement(_Error.default, {
        message: errorMessage,
        showError: showError
    })), /*#__PURE__*/ _react.default.createElement("header", {
        className: `${baseClass}__header`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__header-wrap`
    }, /*#__PURE__*/ _react.default.createElement("div", {
        className: `${baseClass}__heading-with-error`
    }, /*#__PURE__*/ _react.default.createElement("h3", null, (0, _getTranslation.getTranslation)(label || name, i18n)), fieldHasErrors && fieldErrorCount > 0 && /*#__PURE__*/ _react.default.createElement(_ErrorPill.ErrorPill, {
        count: fieldErrorCount,
        withMessage: true
    })), rows.length > 0 && /*#__PURE__*/ _react.default.createElement("ul", {
        className: `${baseClass}__header-actions`
    }, /*#__PURE__*/ _react.default.createElement("li", null, /*#__PURE__*/ _react.default.createElement("button", {
        className: `${baseClass}__header-action`,
        onClick: ()=>toggleCollapseAll(true),
        type: "button"
    }, t('collapseAll'))), /*#__PURE__*/ _react.default.createElement("li", null, /*#__PURE__*/ _react.default.createElement("button", {
        className: `${baseClass}__header-action`,
        onClick: ()=>toggleCollapseAll(false),
        type: "button"
    }, t('showAll'))))), /*#__PURE__*/ _react.default.createElement(_FieldDescription.default, {
        description: description,
        value: value
    })), /*#__PURE__*/ _react.default.createElement(_NullifyField.NullifyLocaleField, {
        fieldValue: value,
        localized: localized,
        path: path
    }), (rows.length > 0 || !valid && (showRequired || showMinRows)) && /*#__PURE__*/ _react.default.createElement(_DraggableSortable.default, {
        className: `${baseClass}__rows`,
        ids: rows.map((row)=>row.id),
        onDragEnd: ({ moveFromIndex, moveToIndex })=>moveRow(moveFromIndex, moveToIndex)
    }, rows.map((row, i)=>{
        const { blockType } = row;
        const blockToRender = blocks.find((block)=>block.slug === blockType);
        if (blockToRender) {
            return /*#__PURE__*/ _react.default.createElement(_DraggableSortableItem.default, {
                disabled: readOnly,
                id: row.id,
                key: row.id
            }, (draggableSortableItemProps)=>/*#__PURE__*/ _react.default.createElement(_BlockRow.BlockRow, {
                    ...draggableSortableItemProps,
                    addRow: addRow,
                    blockToRender: blockToRender,
                    blocks: blocks,
                    duplicateRow: duplicateRow,
                    fieldTypes: fieldTypes,
                    forceRender: forceRender,
                    hasMaxRows: hasMaxRows,
                    indexPath: indexPath,
                    labels: labels,
                    moveRow: moveRow,
                    path: path,
                    permissions: permissions,
                    readOnly: readOnly,
                    removeRow: removeRow,
                    row: row,
                    rowCount: rows.length,
                    rowIndex: i,
                    setCollapse: setCollapse
                }));
        }
        return null;
    }), !editingDefaultLocale && /*#__PURE__*/ _react.default.createElement(_react.default.Fragment, null, showMinRows && /*#__PURE__*/ _react.default.createElement(_Banner.default, {
        type: "error"
    }, t('validation:requiresAtLeast', {
        count: minRows,
        label: (0, _getTranslation.getTranslation)(minRows === 1 || typeof minRows === 'undefined' ? labels.singular : labels.plural, i18n)
    })), showRequired && /*#__PURE__*/ _react.default.createElement(_Banner.default, null, t('validation:fieldHasNo', {
        label: (0, _getTranslation.getTranslation)(labels.plural, i18n)
    })))), !readOnly && !hasMaxRows && /*#__PURE__*/ _react.default.createElement(_react.Fragment, null, /*#__PURE__*/ _react.default.createElement(_Drawer.DrawerToggler, {
        className: `${baseClass}__drawer-toggler`,
        slug: drawerSlug
    }, /*#__PURE__*/ _react.default.createElement(_Button.default, {
        buttonStyle: "icon-label",
        el: "span",
        icon: "plus",
        iconPosition: "left",
        iconStyle: "with-border"
    }, t('addLabel', {
        label: (0, _getTranslation.getTranslation)(labels.singular, i18n)
    }))), /*#__PURE__*/ _react.default.createElement(_BlocksDrawer.BlocksDrawer, {
        addRow: addRow,
        addRowIndex: rows?.length || 0,
        blocks: blocks,
        drawerSlug: drawerSlug,
        labels: labels
    })));
};
const _default = (0, _withCondition.default)(BlocksField);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL2Zvcm1zL2ZpZWxkLXR5cGVzL0Jsb2Nrcy9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IEZyYWdtZW50LCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgdXNlVHJhbnNsYXRpb24gfSBmcm9tICdyZWFjdC1pMThuZXh0J1xuXG5pbXBvcnQgdHlwZSB7IFByb3BzIH0gZnJvbSAnLi90eXBlcydcblxuaW1wb3J0IHsgYmxvY2tzIGFzIGJsb2Nrc1ZhbGlkYXRvciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2ZpZWxkcy92YWxpZGF0aW9ucydcbmltcG9ydCB7IGdldFRyYW5zbGF0aW9uIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vdXRpbGl0aWVzL2dldFRyYW5zbGF0aW9uJ1xuaW1wb3J0IHsgc2Nyb2xsVG9JRCB9IGZyb20gJy4uLy4uLy4uLy4uL3V0aWxpdGllcy9zY3JvbGxUb0lEJ1xuaW1wb3J0IEJhbm5lciBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9CYW5uZXInXG5pbXBvcnQgQnV0dG9uIGZyb20gJy4uLy4uLy4uL2VsZW1lbnRzL0J1dHRvbidcbmltcG9ydCBEcmFnZ2FibGVTb3J0YWJsZSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9EcmFnZ2FibGVTb3J0YWJsZSdcbmltcG9ydCBEcmFnZ2FibGVTb3J0YWJsZUl0ZW0gZnJvbSAnLi4vLi4vLi4vZWxlbWVudHMvRHJhZ2dhYmxlU29ydGFibGUvRHJhZ2dhYmxlU29ydGFibGVJdGVtJ1xuaW1wb3J0IHsgRHJhd2VyVG9nZ2xlciB9IGZyb20gJy4uLy4uLy4uL2VsZW1lbnRzL0RyYXdlcidcbmltcG9ydCB7IHVzZURyYXdlclNsdWcgfSBmcm9tICcuLi8uLi8uLi9lbGVtZW50cy9EcmF3ZXIvdXNlRHJhd2VyU2x1ZydcbmltcG9ydCB7IEVycm9yUGlsbCB9IGZyb20gJy4uLy4uLy4uL2VsZW1lbnRzL0Vycm9yUGlsbCdcbmltcG9ydCB7IHVzZUNvbmZpZyB9IGZyb20gJy4uLy4uLy4uL3V0aWxpdGllcy9Db25maWcnXG5pbXBvcnQgeyB1c2VEb2N1bWVudEluZm8gfSBmcm9tICcuLi8uLi8uLi91dGlsaXRpZXMvRG9jdW1lbnRJbmZvJ1xuaW1wb3J0IHsgdXNlTG9jYWxlIH0gZnJvbSAnLi4vLi4vLi4vdXRpbGl0aWVzL0xvY2FsZSdcbmltcG9ydCBFcnJvciBmcm9tICcuLi8uLi9FcnJvcidcbmltcG9ydCBGaWVsZERlc2NyaXB0aW9uIGZyb20gJy4uLy4uL0ZpZWxkRGVzY3JpcHRpb24nXG5pbXBvcnQgeyB1c2VGb3JtLCB1c2VGb3JtU3VibWl0dGVkIH0gZnJvbSAnLi4vLi4vRm9ybS9jb250ZXh0J1xuaW1wb3J0IHsgTnVsbGlmeUxvY2FsZUZpZWxkIH0gZnJvbSAnLi4vLi4vTnVsbGlmeUZpZWxkJ1xuaW1wb3J0IHVzZUZpZWxkIGZyb20gJy4uLy4uL3VzZUZpZWxkJ1xuaW1wb3J0IHdpdGhDb25kaXRpb24gZnJvbSAnLi4vLi4vd2l0aENvbmRpdGlvbidcbmltcG9ydCB7IGZpZWxkQmFzZUNsYXNzIH0gZnJvbSAnLi4vc2hhcmVkJ1xuaW1wb3J0IHsgQmxvY2tSb3cgfSBmcm9tICcuL0Jsb2NrUm93J1xuaW1wb3J0IHsgQmxvY2tzRHJhd2VyIH0gZnJvbSAnLi9CbG9ja3NEcmF3ZXInXG5pbXBvcnQgJy4vaW5kZXguc2NzcydcblxuY29uc3QgYmFzZUNsYXNzID0gJ2Jsb2Nrcy1maWVsZCdcblxuY29uc3QgQmxvY2tzRmllbGQ6IFJlYWN0LkZDPFByb3BzPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCB7IGkxOG4sIHQgfSA9IHVzZVRyYW5zbGF0aW9uKCdmaWVsZHMnKVxuXG4gIGNvbnN0IHtcbiAgICBuYW1lLFxuICAgIGFkbWluOiB7IGNsYXNzTmFtZSwgY29uZGl0aW9uLCBkZXNjcmlwdGlvbiwgcmVhZE9ubHkgfSxcbiAgICBibG9ja3MsXG4gICAgZmllbGRUeXBlcyxcbiAgICBmb3JjZVJlbmRlciA9IGZhbHNlLFxuICAgIGluZGV4UGF0aCxcbiAgICBsYWJlbCxcbiAgICBsYWJlbHM6IGxhYmVsc0Zyb21Qcm9wcyxcbiAgICBsb2NhbGl6ZWQsXG4gICAgbWF4Um93cyxcbiAgICBtaW5Sb3dzLFxuICAgIHBhdGg6IHBhdGhGcm9tUHJvcHMsXG4gICAgcGVybWlzc2lvbnMsXG4gICAgcmVxdWlyZWQsXG4gICAgdmFsaWRhdGUgPSBibG9ja3NWYWxpZGF0b3IsXG4gIH0gPSBwcm9wc1xuXG4gIGNvbnN0IHBhdGggPSBwYXRoRnJvbVByb3BzIHx8IG5hbWVcblxuICBjb25zdCB7IHNldERvY0ZpZWxkUHJlZmVyZW5jZXMgfSA9IHVzZURvY3VtZW50SW5mbygpXG4gIGNvbnN0IHsgYWRkRmllbGRSb3csIGRpc3BhdGNoRmllbGRzLCByZW1vdmVGaWVsZFJvdywgc2V0TW9kaWZpZWQgfSA9IHVzZUZvcm0oKVxuICBjb25zdCB7IGNvZGU6IGxvY2FsZSB9ID0gdXNlTG9jYWxlKClcbiAgY29uc3QgeyBsb2NhbGl6YXRpb24gfSA9IHVzZUNvbmZpZygpXG4gIGNvbnN0IGRyYXdlclNsdWcgPSB1c2VEcmF3ZXJTbHVnKCdibG9ja3MtZHJhd2VyJylcbiAgY29uc3Qgc3VibWl0dGVkID0gdXNlRm9ybVN1Ym1pdHRlZCgpXG5cbiAgY29uc3QgbGFiZWxzID0ge1xuICAgIHBsdXJhbDogdCgnYmxvY2tzJyksXG4gICAgc2luZ3VsYXI6IHQoJ2Jsb2NrJyksXG4gICAgLi4ubGFiZWxzRnJvbVByb3BzLFxuICB9XG5cbiAgY29uc3QgZWRpdGluZ0RlZmF1bHRMb2NhbGUgPSAoKCkgPT4ge1xuICAgIGlmIChsb2NhbGl6YXRpb24gJiYgbG9jYWxpemF0aW9uLmZhbGxiYWNrKSB7XG4gICAgICBjb25zdCBkZWZhdWx0TG9jYWxlID0gbG9jYWxpemF0aW9uLmRlZmF1bHRMb2NhbGUgfHwgJ2VuJ1xuICAgICAgcmV0dXJuIGxvY2FsZSA9PT0gZGVmYXVsdExvY2FsZVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlXG4gIH0pKClcblxuICBjb25zdCBtZW1vaXplZFZhbGlkYXRlID0gdXNlQ2FsbGJhY2soXG4gICAgKHZhbHVlLCBvcHRpb25zKSA9PiB7XG4gICAgICAvLyBhbHRlcm5hdGl2ZSBsb2NhbGVzIGNhbiBiZSBudWxsXG4gICAgICBpZiAoIWVkaXRpbmdEZWZhdWx0TG9jYWxlICYmIHZhbHVlID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsaWRhdGUodmFsdWUsIHsgLi4ub3B0aW9ucywgbWF4Um93cywgbWluUm93cywgcmVxdWlyZWQgfSlcbiAgICB9LFxuICAgIFttYXhSb3dzLCBtaW5Sb3dzLCByZXF1aXJlZCwgdmFsaWRhdGUsIGVkaXRpbmdEZWZhdWx0TG9jYWxlXSxcbiAgKVxuXG4gIGNvbnN0IHtcbiAgICBlcnJvck1lc3NhZ2UsXG4gICAgcm93cyA9IFtdLFxuICAgIHNob3dFcnJvcixcbiAgICB2YWxpZCxcbiAgICB2YWx1ZSxcbiAgfSA9IHVzZUZpZWxkPG51bWJlcj4oe1xuICAgIGNvbmRpdGlvbixcbiAgICBoYXNSb3dzOiB0cnVlLFxuICAgIHBhdGgsXG4gICAgdmFsaWRhdGU6IG1lbW9pemVkVmFsaWRhdGUsXG4gIH0pXG5cbiAgY29uc3QgYWRkUm93ID0gdXNlQ2FsbGJhY2soXG4gICAgYXN5bmMgKHJvd0luZGV4OiBudW1iZXIsIGJsb2NrVHlwZTogc3RyaW5nKSA9PiB7XG4gICAgICBhd2FpdCBhZGRGaWVsZFJvdyh7XG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBibG9ja1R5cGUsXG4gICAgICAgIH0sXG4gICAgICAgIHBhdGgsXG4gICAgICAgIHJvd0luZGV4LFxuICAgICAgfSlcbiAgICAgIHNldE1vZGlmaWVkKHRydWUpXG5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzY3JvbGxUb0lEKGAke3BhdGh9LXJvdy0ke3Jvd0luZGV4ICsgMX1gKVxuICAgICAgfSwgMClcbiAgICB9LFxuICAgIFthZGRGaWVsZFJvdywgcGF0aCwgc2V0TW9kaWZpZWRdLFxuICApXG5cbiAgY29uc3QgZHVwbGljYXRlUm93ID0gdXNlQ2FsbGJhY2soXG4gICAgKHJvd0luZGV4OiBudW1iZXIpID0+IHtcbiAgICAgIGRpc3BhdGNoRmllbGRzKHsgcGF0aCwgcm93SW5kZXgsIHR5cGU6ICdEVVBMSUNBVEVfUk9XJyB9KVxuICAgICAgc2V0TW9kaWZpZWQodHJ1ZSlcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHNjcm9sbFRvSUQoYCR7cGF0aH0tcm93LSR7cm93SW5kZXggKyAxfWApXG4gICAgICB9LCAwKVxuICAgIH0sXG4gICAgW2Rpc3BhdGNoRmllbGRzLCBwYXRoLCBzZXRNb2RpZmllZF0sXG4gIClcblxuICBjb25zdCByZW1vdmVSb3cgPSB1c2VDYWxsYmFjayhcbiAgICAocm93SW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgcmVtb3ZlRmllbGRSb3coeyBwYXRoLCByb3dJbmRleCB9KVxuICAgICAgc2V0TW9kaWZpZWQodHJ1ZSlcbiAgICB9LFxuICAgIFtwYXRoLCByZW1vdmVGaWVsZFJvdywgc2V0TW9kaWZpZWRdLFxuICApXG5cbiAgY29uc3QgbW92ZVJvdyA9IHVzZUNhbGxiYWNrKFxuICAgIChtb3ZlRnJvbUluZGV4OiBudW1iZXIsIG1vdmVUb0luZGV4OiBudW1iZXIpID0+IHtcbiAgICAgIGRpc3BhdGNoRmllbGRzKHsgbW92ZUZyb21JbmRleCwgbW92ZVRvSW5kZXgsIHBhdGgsIHR5cGU6ICdNT1ZFX1JPVycgfSlcbiAgICAgIHNldE1vZGlmaWVkKHRydWUpXG4gICAgfSxcbiAgICBbZGlzcGF0Y2hGaWVsZHMsIHBhdGgsIHNldE1vZGlmaWVkXSxcbiAgKVxuXG4gIGNvbnN0IHRvZ2dsZUNvbGxhcHNlQWxsID0gdXNlQ2FsbGJhY2soXG4gICAgKGNvbGxhcHNlZDogYm9vbGVhbikgPT4ge1xuICAgICAgZGlzcGF0Y2hGaWVsZHMoeyBjb2xsYXBzZWQsIHBhdGgsIHNldERvY0ZpZWxkUHJlZmVyZW5jZXMsIHR5cGU6ICdTRVRfQUxMX1JPV1NfQ09MTEFQU0VEJyB9KVxuICAgIH0sXG4gICAgW2Rpc3BhdGNoRmllbGRzLCBwYXRoLCBzZXREb2NGaWVsZFByZWZlcmVuY2VzXSxcbiAgKVxuXG4gIGNvbnN0IHNldENvbGxhcHNlID0gdXNlQ2FsbGJhY2soXG4gICAgKHJvd0lEOiBzdHJpbmcsIGNvbGxhcHNlZDogYm9vbGVhbikgPT4ge1xuICAgICAgZGlzcGF0Y2hGaWVsZHMoeyBjb2xsYXBzZWQsIHBhdGgsIHJvd0lELCBzZXREb2NGaWVsZFByZWZlcmVuY2VzLCB0eXBlOiAnU0VUX1JPV19DT0xMQVBTRUQnIH0pXG4gICAgfSxcbiAgICBbZGlzcGF0Y2hGaWVsZHMsIHBhdGgsIHNldERvY0ZpZWxkUHJlZmVyZW5jZXNdLFxuICApXG5cbiAgY29uc3QgaGFzTWF4Um93cyA9IG1heFJvd3MgJiYgcm93cy5sZW5ndGggPj0gbWF4Um93c1xuXG4gIGNvbnN0IGZpZWxkRXJyb3JDb3VudCA9IHJvd3MucmVkdWNlKCh0b3RhbCwgcm93KSA9PiB0b3RhbCArIChyb3c/LmNoaWxkRXJyb3JQYXRocz8uc2l6ZSB8fCAwKSwgMClcbiAgY29uc3QgZmllbGRIYXNFcnJvcnMgPSBzdWJtaXR0ZWQgJiYgZmllbGRFcnJvckNvdW50ICsgKHZhbGlkID8gMCA6IDEpID4gMFxuXG4gIGNvbnN0IHNob3dNaW5Sb3dzID0gcm93cy5sZW5ndGggPCBtaW5Sb3dzIHx8IChyZXF1aXJlZCAmJiByb3dzLmxlbmd0aCA9PT0gMClcbiAgY29uc3Qgc2hvd1JlcXVpcmVkID0gcmVhZE9ubHkgJiYgcm93cy5sZW5ndGggPT09IDBcblxuICByZXR1cm4gKFxuICAgIDxkaXZcbiAgICAgIGNsYXNzTmFtZT17W1xuICAgICAgICBmaWVsZEJhc2VDbGFzcyxcbiAgICAgICAgYmFzZUNsYXNzLFxuICAgICAgICBjbGFzc05hbWUsXG4gICAgICAgIGZpZWxkSGFzRXJyb3JzID8gYCR7YmFzZUNsYXNzfS0taGFzLWVycm9yYCA6IGAke2Jhc2VDbGFzc30tLWhhcy1uby1lcnJvcmAsXG4gICAgICBdXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgLmpvaW4oJyAnKX1cbiAgICAgIGlkPXtgZmllbGQtJHtwYXRoLnJlcGxhY2UoL1xcLi9nLCAnX18nKX1gfVxuICAgID5cbiAgICAgIHtzaG93RXJyb3IgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fZXJyb3Itd3JhcGB9PlxuICAgICAgICAgIDxFcnJvciBtZXNzYWdlPXtlcnJvck1lc3NhZ2V9IHNob3dFcnJvcj17c2hvd0Vycm9yfSAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgICA8aGVhZGVyIGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9faGVhZGVyYH0+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19oZWFkZXItd3JhcGB9PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19oZWFkaW5nLXdpdGgtZXJyb3JgfT5cbiAgICAgICAgICAgIDxoMz57Z2V0VHJhbnNsYXRpb24obGFiZWwgfHwgbmFtZSwgaTE4bil9PC9oMz5cblxuICAgICAgICAgICAge2ZpZWxkSGFzRXJyb3JzICYmIGZpZWxkRXJyb3JDb3VudCA+IDAgJiYgKFxuICAgICAgICAgICAgICA8RXJyb3JQaWxsIGNvdW50PXtmaWVsZEVycm9yQ291bnR9IHdpdGhNZXNzYWdlIC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIHtyb3dzLmxlbmd0aCA+IDAgJiYgKFxuICAgICAgICAgICAgPHVsIGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9faGVhZGVyLWFjdGlvbnNgfT5cbiAgICAgICAgICAgICAgPGxpPlxuICAgICAgICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9faGVhZGVyLWFjdGlvbmB9XG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB0b2dnbGVDb2xsYXBzZUFsbCh0cnVlKX1cbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHt0KCdjb2xsYXBzZUFsbCcpfVxuICAgICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19oZWFkZXItYWN0aW9uYH1cbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHRvZ2dsZUNvbGxhcHNlQWxsKGZhbHNlKX1cbiAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHt0KCdzaG93QWxsJyl9XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8RmllbGREZXNjcmlwdGlvbiBkZXNjcmlwdGlvbj17ZGVzY3JpcHRpb259IHZhbHVlPXt2YWx1ZX0gLz5cbiAgICAgIDwvaGVhZGVyPlxuICAgICAgPE51bGxpZnlMb2NhbGVGaWVsZCBmaWVsZFZhbHVlPXt2YWx1ZX0gbG9jYWxpemVkPXtsb2NhbGl6ZWR9IHBhdGg9e3BhdGh9IC8+XG4gICAgICB7KHJvd3MubGVuZ3RoID4gMCB8fCAoIXZhbGlkICYmIChzaG93UmVxdWlyZWQgfHwgc2hvd01pblJvd3MpKSkgJiYgKFxuICAgICAgICA8RHJhZ2dhYmxlU29ydGFibGVcbiAgICAgICAgICBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX3Jvd3NgfVxuICAgICAgICAgIGlkcz17cm93cy5tYXAoKHJvdykgPT4gcm93LmlkKX1cbiAgICAgICAgICBvbkRyYWdFbmQ9eyh7IG1vdmVGcm9tSW5kZXgsIG1vdmVUb0luZGV4IH0pID0+IG1vdmVSb3cobW92ZUZyb21JbmRleCwgbW92ZVRvSW5kZXgpfVxuICAgICAgICA+XG4gICAgICAgICAge3Jvd3MubWFwKChyb3csIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgYmxvY2tUeXBlIH0gPSByb3dcbiAgICAgICAgICAgIGNvbnN0IGJsb2NrVG9SZW5kZXIgPSBibG9ja3MuZmluZCgoYmxvY2spID0+IGJsb2NrLnNsdWcgPT09IGJsb2NrVHlwZSlcblxuICAgICAgICAgICAgaWYgKGJsb2NrVG9SZW5kZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8RHJhZ2dhYmxlU29ydGFibGVJdGVtIGRpc2FibGVkPXtyZWFkT25seX0gaWQ9e3Jvdy5pZH0ga2V5PXtyb3cuaWR9PlxuICAgICAgICAgICAgICAgICAgeyhkcmFnZ2FibGVTb3J0YWJsZUl0ZW1Qcm9wcykgPT4gKFxuICAgICAgICAgICAgICAgICAgICA8QmxvY2tSb3dcbiAgICAgICAgICAgICAgICAgICAgICB7Li4uZHJhZ2dhYmxlU29ydGFibGVJdGVtUHJvcHN9XG4gICAgICAgICAgICAgICAgICAgICAgYWRkUm93PXthZGRSb3d9XG4gICAgICAgICAgICAgICAgICAgICAgYmxvY2tUb1JlbmRlcj17YmxvY2tUb1JlbmRlcn1cbiAgICAgICAgICAgICAgICAgICAgICBibG9ja3M9e2Jsb2Nrc31cbiAgICAgICAgICAgICAgICAgICAgICBkdXBsaWNhdGVSb3c9e2R1cGxpY2F0ZVJvd31cbiAgICAgICAgICAgICAgICAgICAgICBmaWVsZFR5cGVzPXtmaWVsZFR5cGVzfVxuICAgICAgICAgICAgICAgICAgICAgIGZvcmNlUmVuZGVyPXtmb3JjZVJlbmRlcn1cbiAgICAgICAgICAgICAgICAgICAgICBoYXNNYXhSb3dzPXtoYXNNYXhSb3dzfVxuICAgICAgICAgICAgICAgICAgICAgIGluZGV4UGF0aD17aW5kZXhQYXRofVxuICAgICAgICAgICAgICAgICAgICAgIGxhYmVscz17bGFiZWxzfVxuICAgICAgICAgICAgICAgICAgICAgIG1vdmVSb3c9e21vdmVSb3d9XG4gICAgICAgICAgICAgICAgICAgICAgcGF0aD17cGF0aH1cbiAgICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9ucz17cGVybWlzc2lvbnN9XG4gICAgICAgICAgICAgICAgICAgICAgcmVhZE9ubHk9e3JlYWRPbmx5fVxuICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZVJvdz17cmVtb3ZlUm93fVxuICAgICAgICAgICAgICAgICAgICAgIHJvdz17cm93fVxuICAgICAgICAgICAgICAgICAgICAgIHJvd0NvdW50PXtyb3dzLmxlbmd0aH1cbiAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleD17aX1cbiAgICAgICAgICAgICAgICAgICAgICBzZXRDb2xsYXBzZT17c2V0Q29sbGFwc2V9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvRHJhZ2dhYmxlU29ydGFibGVJdGVtPlxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgICAgfSl9XG4gICAgICAgICAgeyFlZGl0aW5nRGVmYXVsdExvY2FsZSAmJiAoXG4gICAgICAgICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgICAgICAgIHtzaG93TWluUm93cyAmJiAoXG4gICAgICAgICAgICAgICAgPEJhbm5lciB0eXBlPVwiZXJyb3JcIj5cbiAgICAgICAgICAgICAgICAgIHt0KCd2YWxpZGF0aW9uOnJlcXVpcmVzQXRMZWFzdCcsIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IG1pblJvd3MsXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBnZXRUcmFuc2xhdGlvbihcbiAgICAgICAgICAgICAgICAgICAgICBtaW5Sb3dzID09PSAxIHx8IHR5cGVvZiBtaW5Sb3dzID09PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgPyBsYWJlbHMuc2luZ3VsYXJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogbGFiZWxzLnBsdXJhbCxcbiAgICAgICAgICAgICAgICAgICAgICBpMThuLFxuICAgICAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgPC9CYW5uZXI+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIHtzaG93UmVxdWlyZWQgJiYgKFxuICAgICAgICAgICAgICAgIDxCYW5uZXI+XG4gICAgICAgICAgICAgICAgICB7dCgndmFsaWRhdGlvbjpmaWVsZEhhc05vJywgeyBsYWJlbDogZ2V0VHJhbnNsYXRpb24obGFiZWxzLnBsdXJhbCwgaTE4bikgfSl9XG4gICAgICAgICAgICAgICAgPC9CYW5uZXI+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgICAgICAgICl9XG4gICAgICAgIDwvRHJhZ2dhYmxlU29ydGFibGU+XG4gICAgICApfVxuICAgICAgeyFyZWFkT25seSAmJiAhaGFzTWF4Um93cyAmJiAoXG4gICAgICAgIDxGcmFnbWVudD5cbiAgICAgICAgICA8RHJhd2VyVG9nZ2xlciBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2RyYXdlci10b2dnbGVyYH0gc2x1Zz17ZHJhd2VyU2x1Z30+XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIGJ1dHRvblN0eWxlPVwiaWNvbi1sYWJlbFwiXG4gICAgICAgICAgICAgIGVsPVwic3BhblwiXG4gICAgICAgICAgICAgIGljb249XCJwbHVzXCJcbiAgICAgICAgICAgICAgaWNvblBvc2l0aW9uPVwibGVmdFwiXG4gICAgICAgICAgICAgIGljb25TdHlsZT1cIndpdGgtYm9yZGVyXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge3QoJ2FkZExhYmVsJywgeyBsYWJlbDogZ2V0VHJhbnNsYXRpb24obGFiZWxzLnNpbmd1bGFyLCBpMThuKSB9KX1cbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvRHJhd2VyVG9nZ2xlcj5cbiAgICAgICAgICA8QmxvY2tzRHJhd2VyXG4gICAgICAgICAgICBhZGRSb3c9e2FkZFJvd31cbiAgICAgICAgICAgIGFkZFJvd0luZGV4PXtyb3dzPy5sZW5ndGggfHwgMH1cbiAgICAgICAgICAgIGJsb2Nrcz17YmxvY2tzfVxuICAgICAgICAgICAgZHJhd2VyU2x1Zz17ZHJhd2VyU2x1Z31cbiAgICAgICAgICAgIGxhYmVscz17bGFiZWxzfVxuICAgICAgICAgIC8+XG4gICAgICAgIDwvRnJhZ21lbnQ+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApXG59XG5cbmV4cG9ydCBkZWZhdWx0IHdpdGhDb25kaXRpb24oQmxvY2tzRmllbGQpXG4iXSwibmFtZXMiOlsiYmFzZUNsYXNzIiwiQmxvY2tzRmllbGQiLCJwcm9wcyIsImkxOG4iLCJ0IiwidXNlVHJhbnNsYXRpb24iLCJuYW1lIiwiYWRtaW4iLCJjbGFzc05hbWUiLCJjb25kaXRpb24iLCJkZXNjcmlwdGlvbiIsInJlYWRPbmx5IiwiYmxvY2tzIiwiZmllbGRUeXBlcyIsImZvcmNlUmVuZGVyIiwiaW5kZXhQYXRoIiwibGFiZWwiLCJsYWJlbHMiLCJsYWJlbHNGcm9tUHJvcHMiLCJsb2NhbGl6ZWQiLCJtYXhSb3dzIiwibWluUm93cyIsInBhdGgiLCJwYXRoRnJvbVByb3BzIiwicGVybWlzc2lvbnMiLCJyZXF1aXJlZCIsInZhbGlkYXRlIiwiYmxvY2tzVmFsaWRhdG9yIiwic2V0RG9jRmllbGRQcmVmZXJlbmNlcyIsInVzZURvY3VtZW50SW5mbyIsImFkZEZpZWxkUm93IiwiZGlzcGF0Y2hGaWVsZHMiLCJyZW1vdmVGaWVsZFJvdyIsInNldE1vZGlmaWVkIiwidXNlRm9ybSIsImNvZGUiLCJsb2NhbGUiLCJ1c2VMb2NhbGUiLCJsb2NhbGl6YXRpb24iLCJ1c2VDb25maWciLCJkcmF3ZXJTbHVnIiwidXNlRHJhd2VyU2x1ZyIsInN1Ym1pdHRlZCIsInVzZUZvcm1TdWJtaXR0ZWQiLCJwbHVyYWwiLCJzaW5ndWxhciIsImVkaXRpbmdEZWZhdWx0TG9jYWxlIiwiZmFsbGJhY2siLCJkZWZhdWx0TG9jYWxlIiwibWVtb2l6ZWRWYWxpZGF0ZSIsInVzZUNhbGxiYWNrIiwidmFsdWUiLCJvcHRpb25zIiwiZXJyb3JNZXNzYWdlIiwicm93cyIsInNob3dFcnJvciIsInZhbGlkIiwidXNlRmllbGQiLCJoYXNSb3dzIiwiYWRkUm93Iiwicm93SW5kZXgiLCJibG9ja1R5cGUiLCJkYXRhIiwic2V0VGltZW91dCIsInNjcm9sbFRvSUQiLCJkdXBsaWNhdGVSb3ciLCJ0eXBlIiwicmVtb3ZlUm93IiwibW92ZVJvdyIsIm1vdmVGcm9tSW5kZXgiLCJtb3ZlVG9JbmRleCIsInRvZ2dsZUNvbGxhcHNlQWxsIiwiY29sbGFwc2VkIiwic2V0Q29sbGFwc2UiLCJyb3dJRCIsImhhc01heFJvd3MiLCJsZW5ndGgiLCJmaWVsZEVycm9yQ291bnQiLCJyZWR1Y2UiLCJ0b3RhbCIsInJvdyIsImNoaWxkRXJyb3JQYXRocyIsInNpemUiLCJmaWVsZEhhc0Vycm9ycyIsInNob3dNaW5Sb3dzIiwic2hvd1JlcXVpcmVkIiwiZGl2IiwiZmllbGRCYXNlQ2xhc3MiLCJmaWx0ZXIiLCJCb29sZWFuIiwiam9pbiIsImlkIiwicmVwbGFjZSIsIkVycm9yIiwibWVzc2FnZSIsImhlYWRlciIsImgzIiwiZ2V0VHJhbnNsYXRpb24iLCJFcnJvclBpbGwiLCJjb3VudCIsIndpdGhNZXNzYWdlIiwidWwiLCJsaSIsImJ1dHRvbiIsIm9uQ2xpY2siLCJGaWVsZERlc2NyaXB0aW9uIiwiTnVsbGlmeUxvY2FsZUZpZWxkIiwiZmllbGRWYWx1ZSIsIkRyYWdnYWJsZVNvcnRhYmxlIiwiaWRzIiwibWFwIiwib25EcmFnRW5kIiwiaSIsImJsb2NrVG9SZW5kZXIiLCJmaW5kIiwiYmxvY2siLCJzbHVnIiwiRHJhZ2dhYmxlU29ydGFibGVJdGVtIiwiZGlzYWJsZWQiLCJrZXkiLCJkcmFnZ2FibGVTb3J0YWJsZUl0ZW1Qcm9wcyIsIkJsb2NrUm93Iiwicm93Q291bnQiLCJSZWFjdCIsIkZyYWdtZW50IiwiQmFubmVyIiwiRHJhd2VyVG9nZ2xlciIsIkJ1dHRvbiIsImJ1dHRvblN0eWxlIiwiZWwiLCJpY29uIiwiaWNvblBvc2l0aW9uIiwiaWNvblN0eWxlIiwiQmxvY2tzRHJhd2VyIiwiYWRkUm93SW5kZXgiLCJ3aXRoQ29uZGl0aW9uIl0sIm1hcHBpbmdzIjoiOzs7OytCQXdUQTs7O2VBQUE7OzsrREF4VDZDOzhCQUNkOzZCQUlXO2dDQUNYOzRCQUNKOytEQUNSOytEQUNBOzBFQUNXOzhFQUNJO3dCQUNKOytCQUNBOzJCQUNKO3dCQUNBOzhCQUNNO3dCQUNOOzhEQUNSO3lFQUNXO3lCQUNhOzhCQUNQO2lFQUNkO3NFQUNLO3dCQUNLOzBCQUNOOzhCQUNJO1FBQ3RCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFUCxNQUFNQSxZQUFZO0FBRWxCLE1BQU1DLGNBQStCLENBQUNDO0lBQ3BDLE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxDQUFDLEVBQUUsR0FBR0MsSUFBQUEsNEJBQWMsRUFBQztJQUVuQyxNQUFNLEVBQ0pDLElBQUksRUFDSkMsT0FBTyxFQUFFQyxTQUFTLEVBQUVDLFNBQVMsRUFBRUMsV0FBVyxFQUFFQyxRQUFRLEVBQUUsRUFDdERDLE1BQU0sRUFDTkMsVUFBVSxFQUNWQyxjQUFjLEtBQUssRUFDbkJDLFNBQVMsRUFDVEMsS0FBSyxFQUNMQyxRQUFRQyxlQUFlLEVBQ3ZCQyxTQUFTLEVBQ1RDLE9BQU8sRUFDUEMsT0FBTyxFQUNQQyxNQUFNQyxhQUFhLEVBQ25CQyxXQUFXLEVBQ1hDLFFBQVEsRUFDUkMsV0FBV0MsbUJBQWUsRUFDM0IsR0FBR3pCO0lBRUosTUFBTW9C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