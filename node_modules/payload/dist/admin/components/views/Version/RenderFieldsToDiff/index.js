"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _types = require("../../../../../fields/config/types");
const _Nested = /*#__PURE__*/ _interop_require_default(require("./fields/Nested"));
const _diffMethods = require("./fields/diffMethods");
require("./index.scss");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const baseClass = 'render-field-diffs';
const RenderFieldsToDiff = ({ comparison, fieldComponents, fieldPermissions, fields, locales, version })=>/*#__PURE__*/ _react.default.createElement("div", {
        className: baseClass
    }, fields.map((field, i)=>{
        const Component = fieldComponents[field.type];
        const isRichText = field.type === 'richText';
        const diffMethod = _diffMethods.diffMethods[field.type] || 'CHARS';
        if (Component) {
            if ((0, _types.fieldAffectsData)(field)) {
                const valueIsObject = field.type === 'code' || field.type === 'json';
                const versionValue = valueIsObject ? JSON.stringify(version?.[field.name]) : version?.[field.name];
                const comparisonValue = valueIsObject ? JSON.stringify(comparison?.[field.name]) : comparison?.[field.name];
                const hasPermission = fieldPermissions?.[field.name]?.read?.permission;
                const subFieldPermissions = fieldPermissions?.[field.name]?.fields;
                if (hasPermission === false) return null;
                if (field.localized) {
                    return /*#__PURE__*/ _react.default.createElement("div", {
                        className: `${baseClass}__field`,
                        key: i
                    }, locales.map((locale)=>{
                        const versionLocaleValue = versionValue?.[locale];
                        const comparisonLocaleValue = comparisonValue?.[locale];
                        return /*#__PURE__*/ _react.default.createElement("div", {
                            className: `${baseClass}__locale`,
                            key: locale
                        }, /*#__PURE__*/ _react.default.createElement("div", {
                            className: `${baseClass}__locale-value`
                        }, /*#__PURE__*/ _react.default.createElement(Component, {
                            comparison: comparisonLocaleValue,
                            diffMethod: diffMethod,
                            field: field,
                            fieldComponents: fieldComponents,
                            isRichText: isRichText,
                            locale: locale,
                            locales: locales,
                            permissions: subFieldPermissions,
                            version: versionLocaleValue
                        })));
                    }));
                }
                return /*#__PURE__*/ _react.default.createElement("div", {
                    className: `${baseClass}__field`,
                    key: i
                }, /*#__PURE__*/ _react.default.createElement(Component, {
                    comparison: comparisonValue,
                    diffMethod: diffMethod,
                    field: field,
                    fieldComponents: fieldComponents,
                    isRichText: isRichText,
                    locales: locales,
                    permissions: subFieldPermissions,
                    version: versionValue
                }));
            }
            if (field.type === 'tabs') {
                const Tabs = fieldComponents.tabs;
                return /*#__PURE__*/ _react.default.createElement(Tabs, {
                    comparison: comparison,
                    field: field,
                    fieldComponents: fieldComponents,
                    key: i,
                    locales: locales,
                    version: version
                });
            }
            // At this point, we are dealing with a `row` or similar
            if ((0, _types.fieldHasSubFields)(field)) {
                return /*#__PURE__*/ _react.default.createElement(_Nested.default, {
                    comparison: comparison,
                    disableGutter: true,
                    field: field,
                    fieldComponents: fieldComponents,
                    key: i,
                    locales: locales,
                    permissions: fieldPermissions,
                    version: version
                });
            }
        }
        return null;
    }));
const _default = RenderFieldsToDiff;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9hZG1pbi9jb21wb25lbnRzL3ZpZXdzL1ZlcnNpb24vUmVuZGVyRmllbGRzVG9EaWZmL2luZGV4LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IERpZmZNZXRob2QgfSBmcm9tICdyZWFjdC1kaWZmLXZpZXdlci1jb250aW51ZWQnXG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcblxuaW1wb3J0IHR5cGUgeyBQcm9wcyB9IGZyb20gJy4vdHlwZXMnXG5cbmltcG9ydCB7IGZpZWxkQWZmZWN0c0RhdGEsIGZpZWxkSGFzU3ViRmllbGRzIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vZmllbGRzL2NvbmZpZy90eXBlcydcbmltcG9ydCBOZXN0ZWQgZnJvbSAnLi9maWVsZHMvTmVzdGVkJ1xuaW1wb3J0IHsgZGlmZk1ldGhvZHMgfSBmcm9tICcuL2ZpZWxkcy9kaWZmTWV0aG9kcydcbmltcG9ydCAnLi9pbmRleC5zY3NzJ1xuXG5jb25zdCBiYXNlQ2xhc3MgPSAncmVuZGVyLWZpZWxkLWRpZmZzJ1xuXG5jb25zdCBSZW5kZXJGaWVsZHNUb0RpZmY6IFJlYWN0LkZDPFByb3BzPiA9ICh7XG4gIGNvbXBhcmlzb24sXG4gIGZpZWxkQ29tcG9uZW50cyxcbiAgZmllbGRQZXJtaXNzaW9ucyxcbiAgZmllbGRzLFxuICBsb2NhbGVzLFxuICB2ZXJzaW9uLFxufSkgPT4gKFxuICA8ZGl2IGNsYXNzTmFtZT17YmFzZUNsYXNzfT5cbiAgICB7ZmllbGRzLm1hcCgoZmllbGQsIGkpID0+IHtcbiAgICAgIGNvbnN0IENvbXBvbmVudCA9IGZpZWxkQ29tcG9uZW50c1tmaWVsZC50eXBlXVxuXG4gICAgICBjb25zdCBpc1JpY2hUZXh0ID0gZmllbGQudHlwZSA9PT0gJ3JpY2hUZXh0J1xuICAgICAgY29uc3QgZGlmZk1ldGhvZDogRGlmZk1ldGhvZCA9IGRpZmZNZXRob2RzW2ZpZWxkLnR5cGVdIHx8ICdDSEFSUydcblxuICAgICAgaWYgKENvbXBvbmVudCkge1xuICAgICAgICBpZiAoZmllbGRBZmZlY3RzRGF0YShmaWVsZCkpIHtcbiAgICAgICAgICBjb25zdCB2YWx1ZUlzT2JqZWN0ID0gZmllbGQudHlwZSA9PT0gJ2NvZGUnIHx8IGZpZWxkLnR5cGUgPT09ICdqc29uJ1xuICAgICAgICAgIGNvbnN0IHZlcnNpb25WYWx1ZSA9IHZhbHVlSXNPYmplY3RcbiAgICAgICAgICAgID8gSlNPTi5zdHJpbmdpZnkodmVyc2lvbj8uW2ZpZWxkLm5hbWVdKVxuICAgICAgICAgICAgOiB2ZXJzaW9uPy5bZmllbGQubmFtZV1cbiAgICAgICAgICBjb25zdCBjb21wYXJpc29uVmFsdWUgPSB2YWx1ZUlzT2JqZWN0XG4gICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KGNvbXBhcmlzb24/LltmaWVsZC5uYW1lXSlcbiAgICAgICAgICAgIDogY29tcGFyaXNvbj8uW2ZpZWxkLm5hbWVdXG4gICAgICAgICAgY29uc3QgaGFzUGVybWlzc2lvbiA9IGZpZWxkUGVybWlzc2lvbnM/LltmaWVsZC5uYW1lXT8ucmVhZD8ucGVybWlzc2lvblxuICAgICAgICAgIGNvbnN0IHN1YkZpZWxkUGVybWlzc2lvbnMgPSBmaWVsZFBlcm1pc3Npb25zPy5bZmllbGQubmFtZV0/LmZpZWxkc1xuXG4gICAgICAgICAgaWYgKGhhc1Blcm1pc3Npb24gPT09IGZhbHNlKSByZXR1cm4gbnVsbFxuXG4gICAgICAgICAgaWYgKGZpZWxkLmxvY2FsaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2ZpZWxkYH0ga2V5PXtpfT5cbiAgICAgICAgICAgICAgICB7bG9jYWxlcy5tYXAoKGxvY2FsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgY29uc3QgdmVyc2lvbkxvY2FsZVZhbHVlID0gdmVyc2lvblZhbHVlPy5bbG9jYWxlXVxuICAgICAgICAgICAgICAgICAgY29uc3QgY29tcGFyaXNvbkxvY2FsZVZhbHVlID0gY29tcGFyaXNvblZhbHVlPy5bbG9jYWxlXVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2Ake2Jhc2VDbGFzc31fX2xvY2FsZWB9IGtleT17bG9jYWxlfT5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YCR7YmFzZUNsYXNzfV9fbG9jYWxlLXZhbHVlYH0+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Q29tcG9uZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBhcmlzb249e2NvbXBhcmlzb25Mb2NhbGVWYWx1ZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZk1ldGhvZD17ZGlmZk1ldGhvZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQ9e2ZpZWxkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZENvbXBvbmVudHM9e2ZpZWxkQ29tcG9uZW50c31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgaXNSaWNoVGV4dD17aXNSaWNoVGV4dH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxlPXtsb2NhbGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsZXM9e2xvY2FsZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zPXtzdWJGaWVsZFBlcm1pc3Npb25zfVxuICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPXt2ZXJzaW9uTG9jYWxlVmFsdWV9XG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgJHtiYXNlQ2xhc3N9X19maWVsZGB9IGtleT17aX0+XG4gICAgICAgICAgICAgIDxDb21wb25lbnRcbiAgICAgICAgICAgICAgICBjb21wYXJpc29uPXtjb21wYXJpc29uVmFsdWV9XG4gICAgICAgICAgICAgICAgZGlmZk1ldGhvZD17ZGlmZk1ldGhvZH1cbiAgICAgICAgICAgICAgICBmaWVsZD17ZmllbGR9XG4gICAgICAgICAgICAgICAgZmllbGRDb21wb25lbnRzPXtmaWVsZENvbXBvbmVudHN9XG4gICAgICAgICAgICAgICAgaXNSaWNoVGV4dD17aXNSaWNoVGV4dH1cbiAgICAgICAgICAgICAgICBsb2NhbGVzPXtsb2NhbGVzfVxuICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zPXtzdWJGaWVsZFBlcm1pc3Npb25zfVxuICAgICAgICAgICAgICAgIHZlcnNpb249e3ZlcnNpb25WYWx1ZX1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIClcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChmaWVsZC50eXBlID09PSAndGFicycpIHtcbiAgICAgICAgICBjb25zdCBUYWJzID0gZmllbGRDb21wb25lbnRzLnRhYnNcblxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8VGFic1xuICAgICAgICAgICAgICBjb21wYXJpc29uPXtjb21wYXJpc29ufVxuICAgICAgICAgICAgICBmaWVsZD17ZmllbGR9XG4gICAgICAgICAgICAgIGZpZWxkQ29tcG9uZW50cz17ZmllbGRDb21wb25lbnRzfVxuICAgICAgICAgICAgICBrZXk9e2l9XG4gICAgICAgICAgICAgIGxvY2FsZXM9e2xvY2FsZXN9XG4gICAgICAgICAgICAgIHZlcnNpb249e3ZlcnNpb259XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIClcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIHdlIGFyZSBkZWFsaW5nIHdpdGggYSBgcm93YCBvciBzaW1pbGFyXG4gICAgICAgIGlmIChmaWVsZEhhc1N1YkZpZWxkcyhmaWVsZCkpIHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPE5lc3RlZFxuICAgICAgICAgICAgICBjb21wYXJpc29uPXtjb21wYXJpc29ufVxuICAgICAgICAgICAgICBkaXNhYmxlR3V0dGVyXG4gICAgICAgICAgICAgIGZpZWxkPXtmaWVsZH1cbiAgICAgICAgICAgICAgZmllbGRDb21wb25lbnRzPXtmaWVsZENvbXBvbmVudHN9XG4gICAgICAgICAgICAgIGtleT17aX1cbiAgICAgICAgICAgICAgbG9jYWxlcz17bG9jYWxlc31cbiAgICAgICAgICAgICAgcGVybWlzc2lvbnM9e2ZpZWxkUGVybWlzc2lvbnN9XG4gICAgICAgICAgICAgIHZlcnNpb249e3ZlcnNpb259XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH0pfVxuICA8L2Rpdj5cbilcblxuZXhwb3J0IGRlZmF1bHQgUmVuZGVyRmllbGRzVG9EaWZmXG4iXSwibmFtZXMiOlsiYmFzZUNsYXNzIiwiUmVuZGVyRmllbGRzVG9EaWZmIiwiY29tcGFyaXNvbiIsImZpZWxkQ29tcG9uZW50cyIsImZpZWxkUGVybWlzc2lvbnMiLCJmaWVsZHMiLCJsb2NhbGVzIiwidmVyc2lvbiIsImRpdiIsImNsYXNzTmFtZSIsIm1hcCIsImZpZWxkIiwiaSIsIkNvbXBvbmVudCIsInR5cGUiLCJpc1JpY2hUZXh0IiwiZGlmZk1ldGhvZCIsImRpZmZNZXRob2RzIiwiZmllbGRBZmZlY3RzRGF0YSIsInZhbHVlSXNPYmplY3QiLCJ2ZXJzaW9uVmFsdWUiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsImNvbXBhcmlzb25WYWx1ZSIsImhhc1Blcm1pc3Npb24iLCJyZWFkIiwicGVybWlzc2lvbiIsInN1YkZpZWxkUGVybWlzc2lvbnMiLCJsb2NhbGl6ZWQiLCJrZXkiLCJsb2NhbGUiLCJ2ZXJzaW9uTG9jYWxlVmFsdWUiLCJjb21wYXJpc29uTG9jYWxlVmFsdWUiLCJwZXJtaXNzaW9ucyIsIlRhYnMiLCJ0YWJzIiwiZmllbGRIYXNTdWJGaWVsZHMiLCJOZXN0ZWQiLCJkaXNhYmxlR3V0dGVyIl0sIm1hcHBpbmdzIjoiOzs7OytCQTJIQTs7O2VBQUE7Ozs4REF6SGtCO3VCQUlrQzsrREFDakM7NkJBQ1M7UUFDckI7Ozs7OztBQUVQLE1BQU1BLFlBQVk7QUFFbEIsTUFBTUMscUJBQXNDLENBQUMsRUFDM0NDLFVBQVUsRUFDVkMsZUFBZSxFQUNmQyxnQkFBZ0IsRUFDaEJDLE1BQU0sRUFDTkMsT0FBTyxFQUNQQyxPQUFPLEVBQ1IsaUJBQ0MsNkJBQUNDO1FBQUlDLFdBQVdUO09BQ2JLLE9BQU9LLEdBQUcsQ0FBQyxDQUFDQyxPQUFPQztRQUNsQixNQUFNQyxZQUFZVixlQUFlLENBQUNRLE1BQU1HLElBQUksQ0FBQztRQUU3QyxNQUFNQyxhQUFhSixNQUFNRyxJQUFJLEtBQUs7UUFDbEMsTUFBTUUsYUFBeUJDLHdCQUFXLENBQUNOLE1BQU1HLElBQUksQ0FBQyxJQUFJO1FBRTFELElBQUlELFdBQVc7WUFDYixJQUFJSyxJQUFBQSx1QkFBZ0IsRUFBQ1AsUUFBUTtnQkFDM0IsTUFBTVEsZ0JBQWdCUixNQUFNRyxJQUFJLEtBQUssVUFBVUgsTUFBTUcsSUFBSSxLQUFLO2dCQUM5RCxNQUFNTSxlQUFlRCxnQkFDakJFLEtBQUtDLFNBQVMsQ0FBQ2YsU0FBUyxDQUFDSSxNQUFNWSxJQUFJLENBQUMsSUFDcENoQixTQUFTLENBQUNJLE1BQU1ZLElBQUksQ0FBQztnQkFDekIsTUFBTUMsa0JBQWtCTCxnQkFDcEJFLEtBQUtDLFNBQVMsQ0FBQ3BCLFlBQVksQ0FBQ1MsTUFBTVksSUFBSSxDQUFDLElBQ3ZDckIsWUFBWSxDQUFDUyxNQUFNWSxJQUFJLENBQUM7Z0JBQzVCLE1BQU1FLGdCQUFnQnJCLGtCQUFrQixDQUFDTyxNQUFNWSxJQUFJLENBQUMsRUFBRUcsTUFBTUM7Z0JBQzVELE1BQU1DLHNCQUFzQnhCLGtCQUFrQixDQUFDTyxNQUFNWSxJQUFJLENBQUMsRUFBRWxCO2dCQUU1RCxJQUFJb0Isa0JBQWtCLE9BQU8sT0FBTztnQkFFcEMsSUFBSWQsTUFBTWtCLFNBQVMsRUFBRTtvQkFDbkIscUJBQ0UsNkJBQUNyQjt3QkFBSUMsV0FBVyxDQUFDLEVBQUVULFVBQVUsT0FBTyxDQUFDO3dCQUFFOEIsS0FBS2xCO3VCQUN6Q04sUUFBUUksR0FBRyxDQUFDLENBQUNxQjt3QkFDWixNQUFNQyxxQkFBcUJaLGNBQWMsQ0FBQ1csT0FBTzt3QkFDakQsTUFBTUUsd0JBQXdCVCxpQkFBaUIsQ0FBQ08sT0FBTzt3QkFDdkQscUJBQ0UsNkJBQUN2Qjs0QkFBSUMsV0FBVyxDQUFDLEVBQUVULFVBQVUsUUFBUSxDQUFDOzRCQUFFOEIsS0FBS0M7eUNBQzNDLDZCQUFDdkI7NEJBQUlDLFdBQVcsQ0FBQyxFQUFFVCxVQUFVLGNBQWMsQ0FBQzt5Q0FDMUMsNkJBQUNhOzRCQUNDWCxZQUFZK0I7NEJBQ1pqQixZQUFZQTs0QkFDWkwsT0FBT0E7NEJBQ1BSLGlCQUFpQkE7NEJBQ2pCWSxZQUFZQTs0QkFDWmdCLFFBQVFBOzRCQUNSekIsU0FBU0E7NEJBQ1Q0QixhQUFhTjs0QkFDYnJCLFNBQVN5Qjs7b0JBS25CO2dCQUdOO2dCQUVBLHFCQUNFLDZCQUFDeEI7b0JBQUlDLFdBQVcsQ0FBQyxFQUFFVCxVQUFVLE9BQU8sQ0FBQztvQkFBRThCLEtBQUtsQjtpQ0FDMUMsNkJBQUNDO29CQUNDWCxZQUFZc0I7b0JBQ1pSLFlBQVlBO29CQUNaTCxPQUFPQTtvQkFDUFIsaUJBQWlCQTtvQkFDakJZLFlBQVlBO29CQUNaVCxTQUFTQTtvQkFDVDRCLGFBQWFOO29CQUNickIsU0FBU2E7O1lBSWpCO1lBRUEsSUFBSVQsTUFBTUcsSUFBSSxLQUFLLFFBQVE7Z0JBQ3pCLE1BQU1xQixPQUFPaEMsZ0JBQWdCaUMsSUFBSTtnQkFFakMscUJBQ0UsNkJBQUNEO29CQUNDakMsWUFBWUE7b0JBQ1pTLE9BQU9BO29CQUNQUixpQkFBaUJBO29CQUNqQjJCLEtBQUtsQjtvQkFDTE4sU0FBU0E7b0JBQ1RDLFNBQVNBOztZQUdmO1lBRUEsd0RBQXdEO1lBQ3hELElBQUk4QixJQUFBQSx3QkFBaUIsRUFBQzFCLFFBQVE7Z0JBQzVCLHFCQUNFLDZCQUFDMkIsZUFBTTtvQkFDTHBDLFlBQVlBO29CQUNacUMsZUFBQUE7b0JBQ0E1QixPQUFPQTtvQkFDUFIsaUJBQWlCQTtvQkFDakIyQixLQUFLbEI7b0JBQ0xOLFNBQVNBO29CQUNUNEIsYUFBYTlCO29CQUNiRyxTQUFTQTs7WUFHZjtRQUNGO1FBRUEsT0FBTztJQUNUO01BSUosV0FBZU4ifQ==