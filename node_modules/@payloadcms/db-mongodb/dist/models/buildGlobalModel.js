"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "buildGlobalModel", {
    enumerable: true,
    get: function() {
        return buildGlobalModel;
    }
});
const _mongoose = /*#__PURE__*/ _interop_require_default(require("mongoose"));
const _buildQuery = /*#__PURE__*/ _interop_require_default(require("../queries/buildQuery"));
const _buildSchema = /*#__PURE__*/ _interop_require_default(require("./buildSchema"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const buildGlobalModel = (config)=>{
    if (config.globals && config.globals.length > 0) {
        const globalsSchema = new _mongoose.default.Schema({}, {
            discriminatorKey: 'globalType',
            minimize: false,
            timestamps: true
        });
        globalsSchema.plugin((0, _buildQuery.default)());
        const Globals = _mongoose.default.model('globals', globalsSchema, 'globals');
        Object.values(config.globals).forEach((globalConfig)=>{
            const globalSchema = (0, _buildSchema.default)(config, globalConfig.fields, {
                options: {
                    minimize: false
                }
            });
            Globals.discriminator(globalConfig.slug, globalSchema);
        });
        return Globals;
    }
    return null;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tb2RlbHMvYnVpbGRHbG9iYWxNb2RlbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFNhbml0aXplZENvbmZpZyB9IGZyb20gJ3BheWxvYWQvY29uZmlnJ1xuXG5pbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnXG5cbmltcG9ydCB0eXBlIHsgR2xvYmFsTW9kZWwgfSBmcm9tICcuLi90eXBlcydcblxuaW1wb3J0IGdldEJ1aWxkUXVlcnlQbHVnaW4gZnJvbSAnLi4vcXVlcmllcy9idWlsZFF1ZXJ5J1xuaW1wb3J0IGJ1aWxkU2NoZW1hIGZyb20gJy4vYnVpbGRTY2hlbWEnXG5cbmV4cG9ydCBjb25zdCBidWlsZEdsb2JhbE1vZGVsID0gKGNvbmZpZzogU2FuaXRpemVkQ29uZmlnKTogR2xvYmFsTW9kZWwgfCBudWxsID0+IHtcbiAgaWYgKGNvbmZpZy5nbG9iYWxzICYmIGNvbmZpZy5nbG9iYWxzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBnbG9iYWxzU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYShcbiAgICAgIHt9LFxuICAgICAgeyBkaXNjcmltaW5hdG9yS2V5OiAnZ2xvYmFsVHlwZScsIG1pbmltaXplOiBmYWxzZSwgdGltZXN0YW1wczogdHJ1ZSB9LFxuICAgIClcblxuICAgIGdsb2JhbHNTY2hlbWEucGx1Z2luKGdldEJ1aWxkUXVlcnlQbHVnaW4oKSlcblxuICAgIGNvbnN0IEdsb2JhbHMgPSBtb25nb29zZS5tb2RlbCgnZ2xvYmFscycsIGdsb2JhbHNTY2hlbWEsICdnbG9iYWxzJykgYXMgdW5rbm93biBhcyBHbG9iYWxNb2RlbFxuXG4gICAgT2JqZWN0LnZhbHVlcyhjb25maWcuZ2xvYmFscykuZm9yRWFjaCgoZ2xvYmFsQ29uZmlnKSA9PiB7XG4gICAgICBjb25zdCBnbG9iYWxTY2hlbWEgPSBidWlsZFNjaGVtYShjb25maWcsIGdsb2JhbENvbmZpZy5maWVsZHMsIHtcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIG1pbmltaXplOiBmYWxzZSxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgICBHbG9iYWxzLmRpc2NyaW1pbmF0b3IoZ2xvYmFsQ29uZmlnLnNsdWcsIGdsb2JhbFNjaGVtYSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIEdsb2JhbHNcbiAgfVxuXG4gIHJldHVybiBudWxsXG59XG4iXSwibmFtZXMiOlsiYnVpbGRHbG9iYWxNb2RlbCIsImNvbmZpZyIsImdsb2JhbHMiLCJsZW5ndGgiLCJnbG9iYWxzU2NoZW1hIiwibW9uZ29vc2UiLCJTY2hlbWEiLCJkaXNjcmltaW5hdG9yS2V5IiwibWluaW1pemUiLCJ0aW1lc3RhbXBzIiwicGx1Z2luIiwiZ2V0QnVpbGRRdWVyeVBsdWdpbiIsIkdsb2JhbHMiLCJtb2RlbCIsIk9iamVjdCIsInZhbHVlcyIsImZvckVhY2giLCJnbG9iYWxDb25maWciLCJnbG9iYWxTY2hlbWEiLCJidWlsZFNjaGVtYSIsImZpZWxkcyIsIm9wdGlvbnMiLCJkaXNjcmltaW5hdG9yIiwic2x1ZyJdLCJtYXBwaW5ncyI6Ijs7OzsrQkFTYUE7OztlQUFBQTs7O2lFQVBRO21FQUlXO29FQUNSOzs7Ozs7QUFFakIsTUFBTUEsbUJBQW1CLENBQUNDO0lBQy9CLElBQUlBLE9BQU9DLE9BQU8sSUFBSUQsT0FBT0MsT0FBTyxDQUFDQyxNQUFNLEdBQUcsR0FBRztRQUMvQyxNQUFNQyxnQkFBZ0IsSUFBSUMsaUJBQVEsQ0FBQ0MsTUFBTSxDQUN2QyxDQUFDLEdBQ0Q7WUFBRUMsa0JBQWtCO1lBQWNDLFVBQVU7WUFBT0MsWUFBWTtRQUFLO1FBR3RFTCxjQUFjTSxNQUFNLENBQUNDLElBQUFBLG1CQUFtQjtRQUV4QyxNQUFNQyxVQUFVUCxpQkFBUSxDQUFDUSxLQUFLLENBQUMsV0FBV1QsZUFBZTtRQUV6RFUsT0FBT0MsTUFBTSxDQUFDZCxPQUFPQyxPQUFPLEVBQUVjLE9BQU8sQ0FBQyxDQUFDQztZQUNyQyxNQUFNQyxlQUFlQyxJQUFBQSxvQkFBVyxFQUFDbEIsUUFBUWdCLGFBQWFHLE1BQU0sRUFBRTtnQkFDNURDLFNBQVM7b0JBQ1BiLFVBQVU7Z0JBQ1o7WUFDRjtZQUNBSSxRQUFRVSxhQUFhLENBQUNMLGFBQWFNLElBQUksRUFBRUw7UUFDM0M7UUFFQSxPQUFPTjtJQUNUO0lBRUEsT0FBTztBQUNUIn0=