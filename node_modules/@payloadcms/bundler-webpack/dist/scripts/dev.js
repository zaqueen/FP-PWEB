"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "devAdmin", {
    enumerable: true,
    get: function() {
        return devAdmin;
    }
});
const _connecthistoryapifallback = /*#__PURE__*/ _interop_require_default(require("connect-history-api-fallback"));
const _express = /*#__PURE__*/ _interop_require_default(require("express"));
const _webpack = /*#__PURE__*/ _interop_require_default(require("webpack"));
const _webpackdevmiddleware = /*#__PURE__*/ _interop_require_default(require("webpack-dev-middleware"));
const _webpackhotmiddleware = /*#__PURE__*/ _interop_require_default(require("webpack-hot-middleware"));
const _dev = require("../configs/dev");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const router = _express.default.Router();
const devAdmin = async ({ payload })=>{
    router.use((0, _connecthistoryapifallback.default)());
    try {
        const webpackConfig = (0, _dev.getDevConfig)(payload.config);
        const compiler = (0, _webpack.default)(webpackConfig);
        router.use((0, _webpackdevmiddleware.default)(compiler, {
            publicPath: '/'
        }));
        router.use((0, _webpackhotmiddleware.default)(compiler));
    } catch (err) {
        console.error(err);
        throw new Error('Error: there was an error creating the webpack dev server.');
    }
    return router;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL2Rldi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFBheWxvYWQgfSBmcm9tICdwYXlsb2FkJ1xuaW1wb3J0IHR5cGUgeyBQYXlsb2FkSGFuZGxlciB9IGZyb20gJ3BheWxvYWQvY29uZmlnJ1xuXG5pbXBvcnQgaGlzdG9yeSBmcm9tICdjb25uZWN0LWhpc3RvcnktYXBpLWZhbGxiYWNrJ1xuaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcydcbmltcG9ydCB3ZWJwYWNrIGZyb20gJ3dlYnBhY2snXG5pbXBvcnQgd2VicGFja0Rldk1pZGRsZXdhcmUgZnJvbSAnd2VicGFjay1kZXYtbWlkZGxld2FyZSdcbmltcG9ydCB3ZWJwYWNrSG90TWlkZGxld2FyZSBmcm9tICd3ZWJwYWNrLWhvdC1taWRkbGV3YXJlJ1xuXG5pbXBvcnQgeyBnZXREZXZDb25maWcgfSBmcm9tICcuLi9jb25maWdzL2RldidcblxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKVxuXG50eXBlIERldkFkbWluVHlwZSA9IChvcHRpb25zOiB7IHBheWxvYWQ6IFBheWxvYWQgfSkgPT4gUHJvbWlzZTxQYXlsb2FkSGFuZGxlcj5cbmV4cG9ydCBjb25zdCBkZXZBZG1pbjogRGV2QWRtaW5UeXBlID0gYXN5bmMgKHsgcGF5bG9hZCB9KSA9PiB7XG4gIHJvdXRlci51c2UoaGlzdG9yeSgpKVxuXG4gIHRyeSB7XG4gICAgY29uc3Qgd2VicGFja0NvbmZpZyA9IGdldERldkNvbmZpZyhwYXlsb2FkLmNvbmZpZylcbiAgICBjb25zdCBjb21waWxlciA9IHdlYnBhY2sod2VicGFja0NvbmZpZylcblxuICAgIHJvdXRlci51c2UoXG4gICAgICB3ZWJwYWNrRGV2TWlkZGxld2FyZShjb21waWxlciwge1xuICAgICAgICBwdWJsaWNQYXRoOiAnLycsXG4gICAgICB9KSxcbiAgICApXG5cbiAgICByb3V0ZXIudXNlKHdlYnBhY2tIb3RNaWRkbGV3YXJlKGNvbXBpbGVyKSlcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpXG4gICAgdGhyb3cgbmV3IEVycm9yKCdFcnJvcjogdGhlcmUgd2FzIGFuIGVycm9yIGNyZWF0aW5nIHRoZSB3ZWJwYWNrIGRldiBzZXJ2ZXIuJylcbiAgfVxuXG4gIHJldHVybiByb3V0ZXJcbn1cbiJdLCJuYW1lcyI6WyJkZXZBZG1pbiIsInJvdXRlciIsImV4cHJlc3MiLCJSb3V0ZXIiLCJwYXlsb2FkIiwidXNlIiwiaGlzdG9yeSIsIndlYnBhY2tDb25maWciLCJnZXREZXZDb25maWciLCJjb25maWciLCJjb21waWxlciIsIndlYnBhY2siLCJ3ZWJwYWNrRGV2TWlkZGxld2FyZSIsInB1YmxpY1BhdGgiLCJ3ZWJwYWNrSG90TWlkZGxld2FyZSIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIkVycm9yIl0sIm1hcHBpbmdzIjoiOzs7OytCQWNhQTs7O2VBQUFBOzs7a0ZBWE87Z0VBQ0E7Z0VBQ0E7NkVBQ2E7NkVBQ0E7cUJBRUo7Ozs7OztBQUU3QixNQUFNQyxTQUFTQyxnQkFBTyxDQUFDQyxNQUFNO0FBR3RCLE1BQU1ILFdBQXlCLE9BQU8sRUFBRUksT0FBTyxFQUFFO0lBQ3RESCxPQUFPSSxHQUFHLENBQUNDLElBQUFBLGtDQUFPO0lBRWxCLElBQUk7UUFDRixNQUFNQyxnQkFBZ0JDLElBQUFBLGlCQUFZLEVBQUNKLFFBQVFLLE1BQU07UUFDakQsTUFBTUMsV0FBV0MsSUFBQUEsZ0JBQU8sRUFBQ0o7UUFFekJOLE9BQU9JLEdBQUcsQ0FDUk8sSUFBQUEsNkJBQW9CLEVBQUNGLFVBQVU7WUFDN0JHLFlBQVk7UUFDZDtRQUdGWixPQUFPSSxHQUFHLENBQUNTLElBQUFBLDZCQUFvQixFQUFDSjtJQUNsQyxFQUFFLE9BQU9LLEtBQUs7UUFDWkMsUUFBUUMsS0FBSyxDQUFDRjtRQUNkLE1BQU0sSUFBSUcsTUFBTTtJQUNsQjtJQUVBLE9BQU9qQjtBQUNUIn0=